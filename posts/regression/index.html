<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="2021 부산대학교 R을 이용한 통계학개론 수업 복습 및 정리" /><meta property="og:description" content="2021 부산대학교 R을 이용한 통계학개론 수업 복습 및 정리" /><link rel="canonical" href="https://kibeomkim.me/posts/regression/" /><meta property="og:url" content="https://kibeomkim.me/posts/regression/" /><meta property="og:site_name" content="der Wille zur Macht" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-11T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석" /><meta name="google-site-verification" content="1CLBUlwAX10LXrW4RzkPuaeWtey34c3dyngs14cKrCw" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-11T00:00:00+09:00","datePublished":"2022-01-11T00:00:00+09:00","description":"2021 부산대학교 R을 이용한 통계학개론 수업 복습 및 정리","headline":"[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석","mainEntityOfPage":{"@type":"WebPage","@id":"https://kibeomkim.me/posts/regression/"},"url":"https://kibeomkim.me/posts/regression/"}</script><title>[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석 | der Wille zur Macht</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="der Wille zur Macht"><meta name="application-name" content="der Wille zur Macht"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/emoge.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">der Wille zur Macht</a></div><div class="site-subtitle font-italic">10,000 Hours</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://github.com/tigerkey10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkb1004tom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[통계학개론 복습] 회귀분석 개념, 종류, 단순선형회귀분석, 다중선형회귀분석</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1641826800" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-01-11 </em> </span> <span> 업데이트 <em class="" data-ts="1641859200" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-01-11 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="8169 단어"> <em>45 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="회귀분석regression-analysis">회귀분석(Regression Analysis)</h1><p>통계적 모형 중 회귀함수를 찾는 분석이다.</p><h2 id="통계적확률론적-모형"><span class="mr-2">통계적(확률론적) 모형</span><a href="#통계적확률론적-모형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>입력과 출력 사이 관계가 일정하게 대응되지 않는 모형. 항상 오차를 수반한다.</p><p>$Y = f(x_{1}, x_{2}, x_{3}, … x_{n}) + \epsilon$</p><p>$\epsilon$ 이 오차항이며, $N(0, \sigma^{2})$ 을 따르는 확률변숫값이다. 따라서 출력 $Y$ 도 확률변숫값이다.</p><h2 id="수학적결정론적-모형"><span class="mr-2">수학적(결정론적) 모형</span><a href="#수학적결정론적-모형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>입력과 출력 사이 일정한 대응관계 성립하는 모형. 수학적 함수다. 오차를 수반하지 않는다.</p><p>$Y = f(x_{1}, x_{2}, x_{3}, … x_{n})$</p><h2 id="회귀모형은-통계적-모형이다"><span class="mr-2">회귀모형은 통계적 모형이다.</span><a href="#회귀모형은-통계적-모형이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="회귀모형regression-model">회귀모형(Regression Model)</h1><p>회귀모형은 회귀함수 $f(x_{i})$ 와 오차항 $\epsilon$ 으로 구성된다.</p><h2 id="y--fx_1-x_2-x_3--x_n--epsilon"><span class="mr-2">$Y = f(x_{1}, x_{2}, x_{3}, … x_{n}) + \epsilon$</span><a href="#y--fx_1-x_2-x_3--x_n--epsilon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>회귀분석은 위 모형에서 회귀함수 $f(x_{1}, x_{2}, x_{3}, … x_{n})$ 를 찾는 분석이다.</p><ul><li>$Y:$ 반응변수, 종속변수<li>$x_{1}, x_{2}, … x_{n}:$ 설명변수, 독립변수<li>$\epsilon:$ 오차항<li>$f(x_{1}, x_{2}, x_{3}, … x_{n}):$ 회귀함수</ul><h1 id="회귀모형-종류">회귀모형 종류</h1><p>회귀모형 = 회귀함수 + 오차</p><p>회귀함수 종류에 따라 회귀모형을 구분한다.</p><h2 id="모수회귀모형"><span class="mr-2">모수회귀모형</span><a href="#모수회귀모형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>정의: 회귀함수 형태가 고정된 회귀모형</p><ul><li>회귀분석 할 때는 형태 고정된 어떤 회귀함수로 모회귀모형을 설정하고, 그 모회귀모형의 추정모형(적합모형) 을 찾는다.</ul><h2 id="모수회귀모형-종류"><span class="mr-2">모수회귀모형 종류</span><a href="#모수회귀모형-종류" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>단순선형회귀모형: $f(X) = \beta_{0}+\beta_{1}X$. 회귀함수가 1차원 선형함수다.<li>다중선형회귀모형: $f(X) = \beta_{0}+\beta_{1}X_{1}+\beta_{2}X_{2}…+\beta_{n}X_{n}$. 회귀함수가 회귀계수와 설명변수 벡터의 선형조합 형태다.<li>비선형회귀모형: $f(X) = \frac{\beta_{0}X}{\beta_{1}+X}$. 회귀함수는 $\beta$ 와 설명변수 $X$의 비선형결합 형태다.<li>$k-$차 다항회귀모형: $f(X) = \beta_{0}+\beta_{1}X + \beta_{2}X^{2}+\beta_{3}X^{3}…+\beta_{k}X^{k}$. 회귀함수가 회귀계수와 설명변수 $X$ $k$차 항의 선형조합 형태다.<li>로지스틱 회귀모형: 반응변수 $Y$ 가 이항분포(n번 중 성공 횟수)를 따를 때<li>로그선형모형: 반응변수 $Y$가 포아송분포를 따를 때</ul><h2 id="비모수회귀모형"><span class="mr-2">비모수회귀모형</span><a href="#비모수회귀모형" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>정의: 회귀함수 $f(X)$ 형태가 고정되어 있지 않은 회귀모형</p><ul><li>회귀함수는 특정 가정만 만족하면 된다. 예) 3번 미분 가능한 함수</ul><hr /><h1 id="회귀분석의-논리-흐름">회귀분석의 논리 흐름</h1><p>아래와 같이 실현된 데이터를 내가 갖고 있다고 가정해보자.</p><p><img width="292" alt="Screen Shot 2022-01-09 at 21 02 02" data-src="https://user-images.githubusercontent.com/83487073/148681382-179df175-f2b1-4abe-917c-903c2239968e.png" data-proofer-ignore></p><p>이 데이터는 본래 어떤 형태 모형에서 실현되었을까? 알 수 없다. 데이터를 실현시킨 본래 ‘참모형(True model)’ 을 아는 건 신의 영역이다. 인간은 알 수 없다.</p><p>$\Rightarrow$ 데이터를 발생시킨 본래 모형을 ‘참모형(True model)’ 이라고 한다.</p><p><img width="296" alt="Screen Shot 2022-01-09 at 21 09 25" data-src="https://user-images.githubusercontent.com/83487073/148681576-7a8da053-22f3-4b30-abdf-e114081d868c.png" data-proofer-ignore></p><p>따라서 참 모형을 알아내는 건 우리 관심사가 아니다. 무슨 노력을 해도 알 수 없다. 미지의 영역이고, 신의 영역이다.</p><p>따라서 우리 인간은 참 모형의 대안으로, 실현된 데이터를 가장 잘 설명해 줄 수 있을 것 같은 임의의 모형을 ‘설정’ 한다. 이 모형을 ‘설정모형’ 이라고 한다.</p><p>위 산점도를 보니 데이터가 양의 선형 상관관계 있어 보인다. 데이터가 선형으로, 오른쪽 위를 향하고 있으므로 오른쪽 위를 향하는 ‘직선’으로 이 데이터를 잘 설명할 수 있을 걸로 보인다.</p><p>직선 형태 회귀함수 갖는 회귀모형은 단순선형회귀모형이 있다. 단순선형회귀모형을 설정모형으로 선택한다.</p><p>$\Rightarrow$ 설정모형: $Y = \beta_{0}+\beta_{1}X + \epsilon$</p><p><img width="291" alt="Screen Shot 2022-01-09 at 21 19 00" data-src="https://user-images.githubusercontent.com/83487073/148681860-7104ebdc-ac82-4c04-8f45-a44de9e3a2ab.png" data-proofer-ignore></p><p>이 설정모형의 회귀함수 $Y =\beta_{0}+\beta_{1}X$는 $Y \vert{X}$ 분포의 기댓값들을 연결한 것과 같다. 이 회귀함수를 모회귀함수(모회귀선) 라고 한다.</p><p><img width="664" alt="Screen Shot 2022-01-09 at 21 24 59" data-src="https://user-images.githubusercontent.com/83487073/148682084-6aa80cf2-7dd2-48f2-a09a-b37526a67ac2.png" data-proofer-ignore></p><p>[이미지 출처: http://www.aistudy.com/math/regression_lee.htm ]</p><p>하지만 $Y \vert{X}$ 분포 기댓값들은 인간이 알 수 없는 미지의 값이다. 즉, 모회귀선은 알 수 없는 어떤 모수라고 생각할 수 있다. 미지의 모수를 추정하려면 실현된 데이터를 이용해서 추정치를 찾는다. 여기서도 마찬가지로, 실현된 데이터를 이용해서 모회귀선의 추정치를 찾는다.</p><p>회귀선과 실현된 데이터 사이 차이를 ‘잔차’라고 하는데, 이 잔차 제곱합(총 잔차 크기)이 최소가 되는 회귀선을 모회귀선 추정치로 삼는다.</p><p>$\Rightarrow$ 이 추정치를 ‘표본회귀선’ 이라 부른다. 표본회귀선은 $Y \vert{X}$ 분포 기댓값 추정치를 연결한 선이다. 한편 정규분포 기댓값 모수는 하나인데 기댓값 모수 추정치(표본평균)은 표본 얻을 때 마다 달라지는 것 처럼, 표본회귀선도 표본 얻을 때 마다 달라진다. 곧, 1개 표본회귀선은 모회귀선에 대한 여러 추정치중 하나에 불과하다.</p><p><img width="590" alt="Screen Shot 2022-01-09 at 21 38 04" data-src="https://user-images.githubusercontent.com/83487073/148682475-3f895795-f5d3-48f9-a71b-3b29a1d9fce2.png" data-proofer-ignore></p><p>[이미지 출처: http://www.aistudy.com/math/regression_lee.htm ]</p><p>표본회귀선을 회귀함수로 삼은 회귀모형을 표본회귀함수 또는 적합모형(fitted model) 이라고 한다.</p><p>적합모형 = 표본회귀선(회귀함수) + $\epsilon$</p><p><img width="300" alt="Screen Shot 2022-01-09 at 23 17 45" data-src="https://user-images.githubusercontent.com/83487073/148686185-ea613c59-8da5-4333-b240-54cc9be0b80f.png" data-proofer-ignore></p><p>적합모형은 모회귀모형 또는 설정모형에 대한 추정모형이다.</p><p>회귀분석의 최종목표는 주어진 데이터에 대해 적합모형의 회귀함수. 표본회귀선을 찾는 것이다.</p><hr /><h1 id="모수회귀모형---단순선형회귀모형">모수회귀모형 - 단순선형회귀모형</h1><p>정의: 회귀함수가 $f(X) = \beta_{0}+\beta_{1}X$ 선형 형태로 고정된 회귀모형</p><p>특징:</p><ul><li>설명변수 $X$ 가 1개다.</ul><p>형태:</p><p>$Y = \beta_{0} + \beta_{1}X + \epsilon$</p><ul><li>$Y:$ 반응변수<li>$\beta_{0}, \beta_{1}:$ 회귀계수<li>$X:$ 설명변수<li>$\epsilon:$ 잔차</ul><p>두 회귀계수는 확률변숫값이다. 확률변수 내부에 확률분포를 내포한다. $\beta_{0}, \beta_{1}$ 은 확률분포의 기댓값 모수다. 정확하게 알 수 없다. 즉, 추정의 대상이다.</p><p>$\beta_{0}, \beta_{1}$ 이 기댓값 모수이므로, $\beta_{0} + \beta_{1}X$ 의미를 ‘$X$ 에서 $Y$ 기댓값’ 이라고 해석할 수 있다. 이 $Y$ 기댓값에서 잔차 $\epsilon$ 을 더하면 실현된 반응변수 $Y$ 값이 나온다.</p><p>기댓값은 모수이므로 정확하게 알 수 없다. 따라서 $\beta_{0} + \beta_{1}X$ 도 정확하게 알 수 없다. 추정 대상이다. $\beta_{0} + \beta_{1}X$ 를 추정하기 위해 $\beta_{0}$ 와 $\beta_{1}$ 기댓값 모수 추정치를 각각 구한다. 그 점 추정치는 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 이라고 하며, 최소제곱추정(최소자승법) 을 이용해서 구한다.</p><p>기댓값 모수 점 추정치 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 로 구성된 회귀함수 $\hat{\beta_{0}} + \hat{\beta_{1}}X$ 를 표본회귀함수 라고 하고, $\beta_{0} + \beta_{1}X$ 의 추정치로 삼는다. 표본회귀함수는 $Y$ 기댓값 추정치다.</p><p>단순선형회귀모형의 목표는 $Y$ 기댓값 추정치, 그러니까 표본회귀함수 $\hat{\beta_{0}} + \hat{\beta_{1}}X$ 를 찾는 것이다.</p><p>한편, 잔차 $\epsilon$ 은 정규분포 $N(0, \sigma^{2})$ 을 따른다고 알려져 있다. $\sigma^{2}$ 은 알 수 없는 모수 값이다. $\sigma^{2}$ 또는 $\sigma$ 를 알면 회귀모형의 대략적인 잔차 크기를 알 수 있다. $\epsilon$ 의 표준편차 $\sigma$ 는 $\epsilon$ 값들이 기댓값 $0$ 에서 대략적으로 떨어진 정도를 의미한다. 즉, $\epsilon$ 의 대략적 크기다. 이 때문에 $\sigma$ 를 알면 회귀모형의 대략적 잔차 크기를 알 수 있는 것이다.</p><p>회귀모형의 대략적 잔차 크기를 알면 그 회귀모형이 실현된 데이터를 잘 설명하는지(잘 적합 되었는지) 알 수 있다. 대략적 잔차 크기가 작을 수록, 모형이 주어진 데이터를 잘 설명한다(잘 적합되었다). 모형이 실현된 데이터를 잘 설명하는지 판단. 확인하는 것은 모형 선택에서 중요한 절차다. 모형이 주어진 데이터 잘 설명 못하면 데이터를 더 모으거나, 설정모형을 바꿔야 할 것이다. 따라서 잔차 $\epsilon$ 의 분산모수 $\sigma^{2}$ 또는 표준편차 모수 $\sigma$ 를 아는 것도 중요하다. 종합하면 단순선형회귀모형의 최종 목표는 $\beta_{0}, \beta_{1}, \sigma^{2}$ 을 추정하는 것이다.</p><h2 id="단순선형회귀모형-목표-rightarrow-3개-모수-beta_0-beta_1-sigma2-추정"><span class="mr-2">단순선형회귀모형 목표 $\Rightarrow$ 3개 모수 $\beta_{0}, \beta_{1}, \sigma^{2}$ 추정</span><a href="#단순선형회귀모형-목표-rightarrow-3개-모수-beta_0-beta_1-sigma2-추정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>모수추정을 위해. 언제나 그랬듯이, 데이터(표본)를 관측한다. 관측된 표본들과 최소제곱추정(최소자승법) 을 사용해서 모수 추정치를 찾는다.</p><hr /><h1 id="최소제곱추정lse-least-squares-estimation">최소제곱추정(LSE: Least Squares Estimation)</h1><p>정의: 모형의 잔차 제곱합(총 잔차 크기)을 최소화 시키는 $\beta_{0}, \beta_{1}$ 점 추정치를 찾는 방법</p><h2 id="argmin_beta_0-beta_1-sumy_i-haty_i2--argmin_beta_0-beta_1-sumy_i-hatbeta_0hatbeta_1x_i2"><span class="mr-2">$argmin_{\beta_{0}, \beta_{1}} \sum{(Y_{i}-\hat{Y_{i}})^{2}} = argmin_{\beta_{0}, \beta_{1}} \sum{(Y_{i}-(\hat{\beta_{0}}+\hat{\beta_{1}}X_{i}))^{2}}$</span><a href="#argmin_beta_0-beta_1-sumy_i-haty_i2--argmin_beta_0-beta_1-sumy_i-hatbeta_0hatbeta_1x_i2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>목적함수 $\sum{(Y_{i}-(\hat{\beta_{0}}+\hat{\beta_{1}}X_{i}))^{2}}$ 에 대한 최적화 필요조건은 ‘$\hat{\beta_{0}}, \hat{\beta_{1}}$ 으로 각각 편미분한 1차 도함수가 최적값에서 0이 되어야 한다’ 이다.</p><p>1차 도함수를 0 만드는 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 이 최적해(최소해) 이며, 각각 $\beta_{0}, \beta_{1}$ 의 점 추정치다.</p><p>목적함수를 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 으로 편미분 한 결과는 아래와 같다.</p><p>목적함수를 $D$ 라고 칭하겠다.</p><h3 id="편미분-결과"><span class="mr-2">편미분 결과</span><a href="#편미분-결과" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>$\frac{\partial{D}}{\partial{\hat{\beta_{0}}}} = -2\sum{(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$</p><p>$\frac{\partial{D}}{\partial{\hat{\beta_{1}}}} = -2\sum{X_{i}(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$</p><p>여기서 $\sum{(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$ 와 $\sum{X_{i}(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$ 를 ‘정규방정식’ 이라고 한다.</p><h3 id="정규방정식"><span class="mr-2">정규방정식</span><a href="#정규방정식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>$\sum{(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$<li>$\sum{X_{i}(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})} = 0$</ol><p>편미분 결과 1차 도함수를 $0$ 되게 만드는 $\hat{\beta_{0}}$ 과 $\hat{\beta_{1}}$ 을 구하면 아래와 같다.</p><h2 id="beta_0-점-추정치최소제곱추정치-hatbeta_0--bary-hatbeta_1barx"><span class="mr-2">$\beta_{0}$ 점 추정치(최소제곱추정치) $\hat{\beta_{0}} = \bar{Y}-\hat{\beta_{1}}\bar{X}$</span><a href="#beta_0-점-추정치최소제곱추정치-hatbeta_0--bary-hatbeta_1barx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="beta_1-점-추정치최소제곱추정치-hatbeta_1--fracsumx_i-barxy_i-barysumx_i-barx2--fracs_xys_xx"><span class="mr-2">$\beta_{1}$ 점 추정치(최소제곱추정치) $\hat{\beta_{1}} = \frac{\sum{(X_{i}-\bar{X})(Y_{i}-\bar{Y})}}{\sum{(X_{i}-\bar{X})^{2}}} = \frac{S_{XY}}{S_{XX}}$</span><a href="#beta_1-점-추정치최소제곱추정치-hatbeta_1--fracsumx_i-barxy_i-barysumx_i-barx2--fracs_xys_xx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$\hat{\beta_{0}}$ 과 $\hat{\beta_{1}}$ 을 사용해서 만든 회귀함수 $\hat{\beta_{0}}+\hat{\beta_{1}}X$ 가 표본회귀함수(표본회귀선) 이고 $\hat{\beta_{0}}+\hat{\beta_{1}}X$ 를 회귀함수로 사용한 회귀모형이 적합모형(fitted model) 이다.</ul><p><img width="597" alt="Screen Shot 2022-01-10 at 15 27 48" data-src="https://user-images.githubusercontent.com/83487073/148725750-094c0dc9-dc23-4fb3-a525-1fd6016e61fd.png" data-proofer-ignore></p><hr /><h1 id="epsilon-분산모수-sigma2-추정과-beta_0-beta_1-구간추정-및-가설검정">$\epsilon$ 분산모수 $\sigma^{2}$ 추정과 $\beta_{0}, \beta_{1}$ 구간추정 및 가설검정</h1><p>앞에서는 $\beta_{0}, \beta_{1}$ 를 점 추정 했다. 하지만 모수의 점 추정치는 표본 얻을 때 마다 다르며, 여러 개 존재한다. 따라서 점 추정치 이용해서 모수 구간추정 해야 할 필요가 있다.</p><h2 id="epsilon-분산모수-sigma2-추정"><span class="mr-2">$\epsilon$ 분산모수 $\sigma^{2}$ 추정</span><a href="#epsilon-분산모수-sigma2-추정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$\epsilon_{i} = Y_{i}-\hat{Y_{i}} = Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i}$</p><p>$\epsilon \sim N(0, \sigma^{2})$ 이다.</p><p>$\epsilon$ 표본 값들의 비편향 표본분산이 분산모수 $\sigma^{2}$ 의 비편향 추정치가 될 수 있다.</p><p>$s^{2} = \frac{1}{(n-2)}\sum{(\epsilon_{i} - 0)^{2}} = \frac{1}{(n-2)}\sum{\epsilon_{i}^{2}} = \frac{1}{(n-2)}\sum{(Y_{i}-\hat{\beta_{0}}-\hat{\beta_{1}}X_{i})^{2}}$</p><ul><li>$s^{2}$ 을 구하기 위해서는 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 두 값을 알아야만 한다. 즉, $\hat{\beta_{0}}, \hat{\beta_{1}}$ 는 제약조건이다. $s^{2}$ 을 구하는 데 필요한 표본 수 $n - $ 제약조건 $2$ 개 $=$ 자유도 $(n-2)$ 이다. 그래서 $s^{2}$ 구할 때 $(n-2)$ 로 나누는 것이다.</ul><h2 id="epsilon-분산모수-sigma2-점-추정치--s2--frac1n-2sumepsilon_i2"><span class="mr-2">$\epsilon$ 분산모수 $\sigma^{2}$ 점 추정치 = $s^{2} = \frac{1}{(n-2)}\sum{\epsilon_{i}^{2}}$</span><a href="#epsilon-분산모수-sigma2-점-추정치--s2--frac1n-2sumepsilon_i2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h2 id="beta_1-구간추정"><span class="mr-2">$\beta_{1}$ 구간추정</span><a href="#beta_1-구간추정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$95$% 신뢰구간을 구하고 싶다면 점 추정치 $\hat{\beta_{1}}$ 이 따르는 분포에서 면적 $0.95$ 에 해당하는 구간을 찾으면 된다.</p><p>분포의 면적을 좀 더 쉽게 구하기 위해 $\hat{\beta_{1}}$ 을 표준화 시킨다.</p><p>$E[\hat{\beta_{0}}] = \beta_{1}$</p><p>$V[\hat{\beta_{1}}] = \frac{s^{2}}{S_{XX}}$</p><p>$\frac{\hat{\beta_{1}} - \beta_{1}}{\frac{s}{\sqrt{S_{XX}}}} \sim t(n-2)$</p><ul><li>t분포(통계량)는 $s$ 때문에 자유도가 $(n-2)$ 다.</ul><h2 id="beta_0-의-95-신뢰구간"><span class="mr-2">$\beta_{0}$ 의 $95$% 신뢰구간</span><a href="#beta_0-의-95-신뢰구간" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="hatbeta_1-pm-t_alpha2fracssqrts_xx"><span class="mr-2">$\hat{\beta_{1}} \pm t_{\alpha/2}\frac{s}{\sqrt{S_{XX}}}$</span><a href="#hatbeta_1-pm-t_alpha2fracssqrts_xx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h2 id="beta_0-구간추정"><span class="mr-2">$\beta_{0}$ 구간추정</span><a href="#beta_0-구간추정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$\beta_{0}$ 에 대해서도 $\beta_{1}$ 구간추정과 같은 메커니즘을 적용한다.</p><p>$E[\hat{\beta_{0}}] = \beta_{0}$</p><p>$V[\hat{\beta_{0}}] = s^{2}(\frac{1}{n}+\frac{\bar{x}^{2}}{S_{XX}})$</p><p>$\frac{\hat{\beta_{0}} - \beta_{0}}{s\sqrt{\frac{1}{n}+\frac{\bar{x}^{2}}{S_{XX}}}} \sim t(n-2)$</p><ul><li>t분포(통계량)는 $s$ 때문에 자유도가 $(n-2)$ 다.</ul><h2 id="beta_0-의-95-신뢰구간-1"><span class="mr-2">$\beta_{0}$ 의 $95$% 신뢰구간</span><a href="#beta_0-의-95-신뢰구간-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="hatbeta_0pm-t_alpha2ssqrtfrac1nfracbarx2s_xx"><span class="mr-2">$\hat{\beta_{0}}\pm t_{\alpha/2}s\sqrt{\frac{1}{n}+\frac{\bar{x}^{2}}{S_{XX}}}$</span><a href="#hatbeta_0pm-t_alpha2ssqrtfrac1nfracbarx2s_xx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h2 id="beta_0-beta_1-가설검정"><span class="mr-2">$\beta_{0}, \beta_{1}$ 가설검정</span><a href="#beta_0-beta_1-가설검정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$H_{0}: \beta_{i} = \beta_{criterion}$</p><p>$H_{a}: \beta_{i} (\ne or &gt; or &lt;) \beta_{criterion}$</p><ul><li>$\beta_{criterion}$ 은 기준값 상수</ul><p>$\beta_{0}$ 과 $\beta_{1}$ 검정통계량은 두 값의 점 추정치가 된다.</p><ul><li><p>$\beta_{0}$ 검정통계량: $\frac{\hat{\beta_{0}} - \beta_{0}}{s\sqrt{\frac{1}{n}+\frac{\bar{x}^{2}}{S_{XX}}}}$</p><li><p>$\beta_{0}$ 검정통계량 분포: $t(n-2)$</p><li><p>$\beta_{1}$ 검정통계량: $\frac{\hat{\beta_{1}} - \beta_{1}}{\frac{s}{\sqrt{S_{XX}}}}$</p><li><p>$\beta_{1}$ 검정통계량 분포: $t(n-2)$</p></ul><p>이제 유의수준 $\alpha$ 를 적절한 값으로 설정하고, $\beta_{0}, \beta_{1}$ 의 유의확률(p-value) 를 구해서</p><p>유의확률이 유의수준보다 작으면 귀무가설 기각, 대립가설 채택.</p><p>유의확률이 유의수준보다 크면 귀무가설 기각할 수 없음. 으로 결론 지으면 된다.</p><hr /><h1 id="회귀모형의-적합도">회귀모형의 적합도</h1><p>정의: 회귀모형 $\hat{Y}$ 이 $\bar{Y}$ 에 비해 더 나은 정도</p><p>$\Rightarrow$ 회귀모형이 제공하는 설명력이 $\bar{Y}$ 보다 나은 정도</p><h2 id="rightarrow-회귀모형이-제공하는-설명력의-정도"><span class="mr-2">$\Rightarrow$ 회귀모형이 제공하는 설명력의 정도</span><a href="#rightarrow-회귀모형이-제공하는-설명력의-정도" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>회귀모형 적합도는 결정계수 $R^{2}$(또는 $r^{2}$) 로 나타낸다.</p><h2 id="r2-결정계수"><span class="mr-2">$R^{2}$ 결정계수</span><a href="#r2-결정계수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>정의: 회귀모형의 데이터에 대한 적합도(설명력)를 나타내는 값</p><p>$R^{2} = \frac{SST}{SST} = 1-\frac{SSE}{SST}$, $(0 &lt; R^{2} &lt; 1)$</p><ul><li>$SST$: 총 제곱합 $\sum{(Y_{i}-\bar{Y}})^{2}$<li>$SSR$: 회귀 제곱합 $\sum{(\hat{Y_{i}}-\bar{Y})^{2}}$<li>$SSE$: 잔차 제곱합 $\sum{(Y_{i}-\hat{Y_{i}})^{2}}$</ul><p><img width="769" alt="Screen Shot 2022-01-10 at 17 01 48" data-src="https://user-images.githubusercontent.com/83487073/148734060-447eb3f2-b050-4628-8af5-9858f559df40.png" data-proofer-ignore></p><ul><li>결정계숫값이 0에 가까울 수록 회귀모형이 X,Y 사이 관계를 제대로 설명 못한다는 말이다.<li>결정계숫값이 1에 가까울 수록 회귀모형이 X,Y 사이 관계를 잘 설명한다는 말이다.<li>단순선형회귀에서는 표본상관계수(피어슨 상관계수) $r$ 값을 제곱하면 결정계숫값과 같아진다.</ul><h1 id="sst-ssr-sse-사이-관계와-분산분석-표anova-table">SST, SSR, SSE 사이 관계와 분산분석 표(ANOVA Table)</h1><p>회귀모형의 3개 제곱합, SST, SSR, SSE 사이 관계는 아래와 같이 유도할 수 있다.</p><p>$Y_{i} - \bar{Y} = \hat{Y_{i}}-\bar{Y} + Y_{i}-\hat{Y}_{i}$</p><p>양변을 제곱하면</p><p>$(Y_{i} - \bar{Y})^{2} = (\hat{Y_{i}}-\bar{Y})^{2} + (Y_{i}-\hat{Y_{i}})^{2} + 2(\hat{Y_{i}}-\bar{Y})(Y_{i}-\hat{Y_{i}})$</p><p>$\sum{(Y_{i} - \bar{Y})^{2}} = \sum{(\hat{Y_{i}}-\bar{Y})^{2}} + \sum{(Y_{i}-\hat{Y_{i}})^{2}} + \sum{2(\hat{Y_{i}}-\bar{Y})(Y_{i}-\hat{Y_{i}})}$</p><p>여기서 $\sum{2(\hat{Y_{i}}-\bar{Y})(Y_{i}-\hat{Y_{i})}}$ 은 $0$ 이 된다.</p><h2 id="정규방정식으로-cross-product-term--0-증명"><span class="mr-2">정규방정식으로 cross product term $= 0$ 증명</span><a href="#정규방정식으로-cross-product-term--0-증명" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$\sum{2(\hat{Y_{i}}-\bar{Y})(Y_{i}-\hat{Y_{i}})}$ 에서 $(Y_{i}-\hat{Y_{i}})$ 를 앞으로 분배한다.</p><p>$\Rightarrow 2\sum{\hat{Y_{i}}(Y_{i}-\hat{Y_{i}})} - 2\sum{\bar{Y}(Y_{i}-\hat{Y}_{i})}$</p><p>정규방정식 1번은 $\sum{(Y_{i}-\hat{Y_{i}})} = 0$ 이었다.</p><p>두 번째 항 $2\sum{\bar{Y}(Y_{i}-\hat{Y_{i}})}$ 은 정규방정식 1번에 의해 0 된다.</p><p>$2\bar{Y}\sum{(Y_{i}-\hat{Y_{i}})} = 0$</p><p>그러면 첫번째 항 $2\sum{\hat{Y_{i}}(Y_{i}-\hat{Y_{i}})}$ 만 남는다.</p><p>$\hat{Y_{i}} = \hat{\beta_{0}} + \hat{\beta_{1}}x_{i}$ 를 이용해서 $2\sum{\hat{Y_{i}}(Y_{i}-\hat{Y_{i}})}$ 를 변형시키자.</p><p>$\Rightarrow$ $2\sum{(\hat{\beta_{0}}+\hat{\beta_{1}}x_{i})(Y_{i}-\hat{Y_{i}})}$</p><p>$(Y_{i}-\hat{Y_{i}})$ 를 앞으로 분배하자.</p><p>$\Rightarrow 2\sum{\hat{\beta_{0}}(Y_{i}-\hat{Y_{i}})+2\sum{\hat{\beta_{1}}x_{i}(Y_{i}-\hat{Y_{i}})}}$</p><p>위 식에서 첫 번째 항 $2\sum{\hat{\beta_{0}}(Y_{i}-\hat{Y_{i}})}$ 은 앞에서 사용한 정규방정식 1번에 의해 $0$ 된다.</p><p>$2\hat{\beta_{0}}\sum{(Y_{i}-\hat{Y_{i}})} = 0$</p><p>정규방정식 2번은 $\sum{x_{i}(Y_{i}-\hat{Y_{i}})} = 0$ 이었다.</p><p>위 식에서 두 번째 항 $2\sum{\hat{\beta_{1}}x_{i}(Y_{i}-\hat{Y_{i}})}$ 은 정규방정식 2번에 의해 $0$ 된다.</p><p>$2\hat{\beta_{1}}\sum{x_{i}(Y_{i}-\hat{Y_{i}})} = 0$</p><p>결국 $0+0 = 0$ 된다.</p><h2 id="sst-ssr-sse-사이-관계"><span class="mr-2">SST, SSR, SSE 사이 관계</span><a href="#sst-ssr-sse-사이-관계" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="rightarrow-sumy_i---bary2--sumhaty_i-bary2--sumy_i-haty_i2"><span class="mr-2">$\Rightarrow \sum{(Y_{i} - \bar{Y})^{2}} = \sum{(\hat{Y_{i}}-\bar{Y})^{2}} + \sum{(Y_{i}-\hat{Y}_{i})^{2}}$</span><a href="#rightarrow-sumy_i---bary2--sumhaty_i-bary2--sumy_i-haty_i2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$\sum{(Y_{i} - \bar{Y})^{2}}:$ 총 제곱합(Total Sum of Squares)<li>$\sum{(\hat{Y_{i}}-\bar{Y})^{2}}:$ 회귀 제곱합(Regression Sum of Squares)<li>$\sum{(Y_{i}-\hat{Y}_{i})^{2}}:$ 잔차 제곱합(Error Sum of Squares)<li>총 제곱합은 $X$ 에 상관없이 고정된 값이다. 총 제곱합이 고정되어 있으므로, 회귀제곱합과 잔차제곱합은 반대로 움직인다. 회귀모형 적합도가 높아지면 회귀제곱합이 커지고 잔차 제곱합이 작아진다. 반대도 성립한다.</ul><h2 id="각-제곱합의-자유도"><span class="mr-2">각 제곱합의 자유도</span><a href="#각-제곱합의-자유도" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>총 제곱합: $\bar{Y}$ 때문에 제약조건이 1개 있다. 따라서 $n-1$<li>잔차 제곱합: $\hat{Y_{i}} = \hat{\beta_{0}}+\hat{\beta_{1}}x_{i}$ 이었다. $\hat{Y_{i}}$ 을 구하려면 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 이 필요하다. 따라서 제약조건이 2개다. 자유도$: n-2$<li>회귀 제곱합: 총 제곱합 자유도$(n-1)$ - 잔차 제곱합 자유도$(n-2)$ $=1$ 이다.</ul><p>분산분석표(ANOVA Table) 을 이용하면 위 관계와 각 제곱합의 자유도, 평균제곱, F비를 한번에 나타낼 수 있다.</p><h2 id="회귀의-분산분석표"><span class="mr-2">회귀의 분산분석표</span><a href="#회귀의-분산분석표" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img width="1236" alt="Screen Shot 2022-01-10 at 17 53 31" data-src="https://user-images.githubusercontent.com/83487073/148739507-c8b7e1ad-4fa7-42b8-8afe-eba1a04fc825.png" data-proofer-ignore></p><p>[이미지 출처: 부산대학교 김충락 교수님의 R을 이용한 통계학개론 - 07_회귀분석.pdf 23 페이지]</p><ul><li><p>평균제곱: $\frac{제곱합}{자유도}$</p><li><p>$F$비: $\frac{MSR}{MSE}$, 모형 전체의 통계적 유의성을 검정할 때 사용한다.</p><li><p>$R^{2}$ 결정계수: $\frac{SSR}{SST} = 1-\frac{SSE}{SST}$</p></ul><hr /><h1 id="r에서-단순선형회귀분석-하기">R에서 단순선형회귀분석 하기</h1><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="c1"># 단순선형회귀분석</span><span class="w">

</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">9</span><span class="p">)</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">9</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">9</span><span class="p">,</span><span class="m">14</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">22</span><span class="p">,</span><span class="m">18</span><span class="p">,</span><span class="m">22</span><span class="p">,</span><span class="m">24</span><span class="p">)</span><span class="w">

</span><span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="nf">length</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w">

</span><span class="c1"># 단순선형회귀모형으로 적합 </span><span class="w">
</span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="c1"># y: 종속변수 , x: 설명변수 </span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="559" alt="Screen Shot 2022-01-10 at 18 06 54" data-src="https://user-images.githubusercontent.com/83487073/148741051-ff319fa0-0a2c-47a8-9b55-430d5fe05689.png" data-proofer-ignore></p><h2 id="summary-결과-설명"><span class="mr-2">summary() 결과 설명</span><a href="#summary-결과-설명" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="residuals"><span class="mr-2">Residuals</span><a href="#residuals" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>$Y_{i} - \hat{Y_{i}}$ 잔차 값들의 최솟값, 1분위수, 중앙값, 3분위수, 최댓값 출력</p><h2 id="coefficients"><span class="mr-2">Coefficients</span><a href="#coefficients" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최소제곱추정으로 구한 회귀계수 추정치 $\hat{\beta_{0}}, \hat{\beta_{1}}$ 출력한다.</p><p>Intercept 가 $\hat{\beta_{0}}$ 에 해당하고, x 가 $\hat{\beta_{1}}$ 에 해당한다. 각각 -1.3594, 2.7897 이 나왔다(Estimate).</p><p>한편 두 점 추정치를 표준화 한 $t$ 통계량 값도 볼 수 있다(t value). 각각 -0.544, 6.958 이다. 둘 다 자유도 8(10-2)인 $t$ 분포를 따른다.</p><p>이 $t$ 통계량을 검정통계량, $t$ 분포를 검정통계량분포로 삼았을 때 유의확률이 가장 오른쪽 값이다. 각각 0.601495, 0.000117 이 나온 걸 관찰할 수 있다. 그리고 그 유의확률에 따른 귀무가설 기각 여부를 별(*) 표시로 알 수 있다.</p><p>여기서 귀무가설은 $H_{0}: \hat{\beta_{i}} = 0$ (회귀계수가 의미 없다) 가 된다. 대립가설은 ‘회귀계수는 통계적으로 유의미하다’가 된다. Intercept는 별이 없다. 유의확률 값이 커서 회귀계수가 통계적으로 유의미하지 않다. 반면 X 는 별이 있다. 유의확률값이 작아서 $\hat{\beta_{1}}$ 이 통계적으로 유의미함을 나타낸다.</p><p>각 회귀계수의 통계적 유의성에 따라, 회귀모형은 최종으로 $\hat{Y_{i}} = \hat{\beta_{1}}X_{i}$ 가 된다.</p><h2 id="residual-standard-error"><span class="mr-2">Residual standard error</span><a href="#residual-standard-error" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>잔차의 표본표준편차 $s$ 를 말한다. 회귀모형이 대체로 어느 정도의 잔차를 갖는지 알려준다. $s = 2.564$ 가 나왔다. 그리고 $s$ 의 자유도는 8(10-2) 가 나온다.</p><h2 id="multiple-r-squared"><span class="mr-2">Multiple R-squared</span><a href="#multiple-r-squared" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>결정계숫값 $R^{2}$ 이다. 0.8592 가 나왔다. 회귀모형의 설명력이 꽤 높은 편이다.</p><h2 id="adjusted-r-squared"><span class="mr-2">Adjusted R-squared</span><a href="#adjusted-r-squared" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>다중회귀모형의 경우 모형에 여러 변수를 많이 넣으면 많이 넣을 수록, 개별 독립변수 $X_{i}$ 의 $Y$ 에 대한 설명력 유무에 관계 없이 모형의 결정계숫값(설명력) 이 올라가는 경향이 나타난다.</p><p>즉, 모형에 포함된 어떤 $X_{i}$ 가 $Y$ 설명에 별 도움이 안되는데도 모형에 설명변수를 많이 넣었다는 이유 만으로 모형의 ‘설명력이 높다’고 나올 수 있다.</p><p>이 문제를 해결하기 위해 사용하는 게 조정된 결정계숫값이다. 조정된 결정계숫값은 개별 변수의 데이터 수 보다 변수 갯수가 더 많아지면(선형종속 발생 환경), 추가되는 설명변수에 대해 패널티를 부여해서 값을 산출한다.</p><p>다중선형회귀모형 일 때는 결정계숫값과 조정된 결정계숫값 두 가지를 모두 보는 것이 좋다. 만약 두 값 사이 차이가 크다면, 종속변수 $Y$ 설명에 별 도움 안 되는 설명변수 $X$ 가 모형에 끼어있을 수 있을 수 있다.</p><h2 id="f-statistic"><span class="mr-2">F-statistic</span><a href="#f-statistic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>F비 값이다. $F = \frac{MSR}{MSE}$. 모형 전체의 통계적 유의성을 검정할 때 사용한다.</p><p>귀무가설은 ‘$\hat{\beta_{0}}$ 을 제외한 모든 회귀계숫값 = 0(통계적 관점에서, 모형이 유의미하지 않다)’, 대립가설은 ‘최소한 회귀계수 하나는 0이 아니다(통계적 관점에서, 모형이 유의미하다)’ 이다.</p><p>F비 값이 따르는 F 분포는 자유도로 (MSR자유도, MSE자유도) 를 갖는다. 이 경우에는 회귀제곱합의 자유도 1, 잔차제곱합의 자유도 8 이라서 DF가 1 and 8로 나왔다.</p><p>F분포 상에서 F비 값 48.48의 유의확률은 0.0001174로, $\alpha = 0.05, 0.01, 0.1$ 세 유의수준보다 모두 낮다. 따라서 이 회귀모형은 통계적 유의성을 갖는다.</p><hr /><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 잔차 출력 </span><span class="w">
</span><span class="n">resid</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">

</span><span class="c1"># 또는 </span><span class="w">
</span><span class="n">rr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fitted</span><span class="p">(</span><span class="n">fit</span><span class="p">);</span><span class="n">rr</span><span class="w">
</span></pre></table></code></div></div><p><img width="828" alt="Screen Shot 2022-01-10 at 18 08 39" data-src="https://user-images.githubusercontent.com/83487073/148741230-2b233d4a-3a61-4b95-b9f9-5204950cdd45.png" data-proofer-ignore></p><p>resid() 명령은 잔차 $\epsilon_{i}$ 를 출력해준다.</p><hr /><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 회귀계수 만 출력 </span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">

</span><span class="c1"># 또는 </span><span class="w">
</span><span class="n">fit</span><span class="o">$</span><span class="n">coefficients</span><span class="w">
</span></pre></table></code></div></div><p><img width="283" alt="Screen Shot 2022-01-10 at 18 54 42" data-src="https://user-images.githubusercontent.com/83487073/148746870-3bffbcdf-7115-4411-94ae-fd33f8c0657d.png" data-proofer-ignore></p><hr /><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀계수의 신뢰구간 </span><span class="w">
</span><span class="n">confint</span><span class="p">(</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="o">=</span><span class="m">0.95</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="299" alt="Screen Shot 2022-01-10 at 18 56 40" data-src="https://user-images.githubusercontent.com/83487073/148747108-3025d7be-46b4-42ca-9120-e239409c9fca.png" data-proofer-ignore></p><hr /><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># 산점도에 표본회귀선을 그리고 싶을 때 </span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="713" alt="Screen Shot 2022-01-10 at 18 58 05" data-src="https://user-images.githubusercontent.com/83487073/148747336-73b8d438-de2a-42ae-8a8a-6e360cff47cb.png" data-proofer-ignore></p><hr /><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 분산분석표 ANOVA Table </span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="524" alt="Screen Shot 2022-01-10 at 19 01 30" data-src="https://user-images.githubusercontent.com/83487073/148747800-e0e9f6f6-8aa4-4351-aa5b-f8c874f4e6d9.png" data-proofer-ignore></p><p>요인 중 회귀와 잔차(오차)가 제시된 분산분석표를 볼 수 있다.</p><p>참고)</p><p><img width="1236" alt="Screen Shot 2022-01-10 at 17 53 31" data-src="https://user-images.githubusercontent.com/83487073/148739507-c8b7e1ad-4fa7-42b8-8afe-eba1a04fc825.png" data-proofer-ignore></p><hr /><h1 id="모수회귀모형---다중선형회귀모형">모수회귀모형 - 다중선형회귀모형</h1><p>p개 변수 관측치 벡터의 선형조합.</p><h2 id="y--beta_01beta_1x_1beta_2x_2beta_p-1x_p-1epsilon"><span class="mr-2">$Y = \beta_{0}1+\beta_{1}X_{1}+\beta_{2}X_{2}+…\beta_{p-1}X_{p-1}+\epsilon$</span><a href="#y--beta_01beta_1x_1beta_2x_2beta_p-1x_p-1epsilon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$X_{i}$ 는 $i$ 번째 변수의 관측치 벡터<li>$\beta_{i}$ 는 다른 변수와 독립적으로 변수 $X_{i}$가 1 증가할 때 $Y$ 가 증가하는 양<li>$\beta_{i}$ 는 스칼라 값, $1$ 과 $X_{i}$ 는 벡터</ul><h2 id="위-식을-행렬-이용해서-아래와-같이-나타낼-수도-있다"><span class="mr-2">위 식을 행렬 이용해서 아래와 같이 나타낼 수도 있다.</span><a href="#위-식을-행렬-이용해서-아래와-같이-나타낼-수도-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img width="903" alt="Screen Shot 2022-01-11 at 14 51 17" data-src="https://user-images.githubusercontent.com/83487073/148888535-7b428f94-4ee2-4153-a70e-a6a0104399f6.png" data-proofer-ignore></p><p>[이미지 출처: 부산대학교 김충락 교수님의 R을 이용한 통계학개론 - 07_회귀분석.pdf 28페이지]</p><h2 id="y--xbeta--epsilon"><span class="mr-2">$Y = X\beta + \epsilon$</span><a href="#y--xbeta--epsilon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>$Y$ 는 $(n \times 1)$ 차원 벡터<li>$X$ 는 $p-1$ 개 변수의 $n$ 개 관측치로 구성된 $(n\times p)$ 차원 행렬<li>$\beta$ 는 각 변수의 가중치로 구성된 $(p\times{1})$ 벡터<li>$\epsilon$ 은 관측치 $Y_{i}$와 $Y$ 기댓값 예측치 사이 잔차값들로 구성된 $(n\times{1})$ 벡터</ul><h2 id="다중선형회귀모형의-최종-목표"><span class="mr-2">다중선형회귀모형의 최종 목표:</span><a href="#다중선형회귀모형의-최종-목표" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="가중치-벡터-beta-를-찾는-것"><span class="mr-2">가중치 벡터 $\beta$ 를 찾는 것.</span><a href="#가중치-벡터-beta-를-찾는-것" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>가중치 벡터 $\beta$ 는 알 수 없는 모수 값들로 구성되어 있다.</p><p>$\beta = [\beta_{0}, \beta_{1}, \beta_{2}, … \beta_{p-1}]^{T}$</p><p>따라서 단순선형회귀분석에서 회귀계수 $\beta_{0}$ 과 $\beta_{1}$ 을 찾을 때와 마찬가지로, ‘추정’ 해야 한다.</p><h2 id="가중치-벡터-beta-를-추정하는-방법은-단순선형회귀분석과-마찬가지로-잔차-제곱합잔차-총-크기가-최소가-되는-beta-를-찾는-것이다"><span class="mr-2">가중치 벡터 $\beta$ 를 추정하는 방법은 단순선형회귀분석과 마찬가지로, 잔차 제곱합(잔차 총 크기)가 최소가 되는 $\beta$ 를 찾는 것이다.</span><a href="#가중치-벡터-beta-를-추정하는-방법은-단순선형회귀분석과-마찬가지로-잔차-제곱합잔차-총-크기가-최소가-되는-beta-를-찾는-것이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>잔차 총 크기 = 잔차 벡터 $norm^{2}$ 하면 얻을 수 있다.</p><p>${\vert{\epsilon}\vert{}}^{2} = \sqrt{요소 제곱합}^{2} =$ 요소제곱합</p><p>$\Rightarrow \sum{\epsilon_{i}^{2}} = \epsilon^{T}\epsilon$</p><p>위에서 $Y = X\beta+\epsilon$ 이었다. $X\beta$ 를 좌변으로 넘기면</p><p>$\epsilon = Y-X\beta$ 가 된다.</p><p>$\Rightarrow \epsilon^{T}\epsilon = (Y-X\beta)^{T}(Y-X\beta)$</p><p>목표는 $(Y-X\beta)^{T}(Y-X\beta)$ 가 최소가 되는 $\beta$ 를 찾는 것이다.</p><p>$argmin_{\beta}{(Y-X\beta)^{T}(Y-X\beta)}$</p><p>$\Rightarrow (Y-X\beta)^{T}(Y-X\beta) = (Y^{T}-\beta^{T}X^{T})(Y-X\beta)$</p><p>앞의 괄호를 뒤로 분배하면</p><p>$Y^{T}Y-Y^{T}X\beta-\beta^{T}X^{T}Y + \beta^{T}X^{T}X\beta$</p><p>두번째 항 $Y^{T}X\beta$ 는 스칼라 값이다. 통째로 전치연산 해도 같다.</p><p>$= Y^{T}Y-(Y^{T}X\beta)^{T}-\beta^{T}X^{T}Y + \beta^{T}X^{T}X\beta$</p><p>$= Y^{T}Y-\beta^{T}X^{T}Y-\beta^{T}X^{T}Y + \beta^{T}X^{T}X\beta$</p><p>최적화(최소화) 목적함수: $Y^{T}Y-2\beta^{T}X^{T}Y+ \beta^{T}X^{T}X\beta$</p><p>최적화 필요조건인 기울기 필요조건을 만족하는 $\beta$ 를 찾자.</p><p>$\beta$ 로 편미분 한 1차 도함수가 0 되는 $\beta$ 를 찾아야 한다.</p><p>$\frac{\partial{목적함수}}{\partial{\beta}} = -2X^{T}Y+2X^{T}X\beta = 0$</p><p>$2X^{T}X\beta = 2X^{T}Y$</p><p>$X^{T}X\beta = X^{T}Y$</p><p>$X^{T}X$ 는 $(p\times{p})$ 크기 정방행렬이다. 만약 $X^{T}X$ 행렬의 역행렬이 존재한다면 아래와 같이 처리할 수 있다.</p><p>$\beta = (X^{T}X)^{-1}X^{T}Y$</p><p>위 $\beta$ 가 최적해(최소해) 다. 잔차 제곱합(총 잔차 크기)을 최소로 만드는 $\beta$ 다.</p><h2 id="가중치-벡터-beta-의-추정치-이다"><span class="mr-2">가중치 벡터 $\beta$ 의 추정치 이다.</span><a href="#가중치-벡터-beta-의-추정치-이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="hatbeta--xtx-1xty"><span class="mr-2">$\hat{\beta} = (X^{T}X)^{-1}X^{T}Y$</span><a href="#hatbeta--xtx-1xty" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="다중선형회귀에서-sst-ssr-sse-사이-관계와-분산분석표">다중선형회귀에서 SST, SSR, SSE 사이 관계와 분산분석표</h1><h2 id="sst-ssr-sse-사이-관계-1"><span class="mr-2">SST, SSR, SSE 사이 관계</span><a href="#sst-ssr-sse-사이-관계-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>단순선형회귀분석과 같다. 다만 자유도가 다르다.</p><p>$\sum{(Y_{i}-\bar{Y})^{2}}= \sum{(\hat{Y_{i}}-\bar{Y})^{2}}+\sum{(Y_{i}-\hat{Y_{i}})^{2}}$</p><ul><li>$\sum{(Y_{i}-\bar{Y})^{2}}$: 총제곱합(SST)<li>$\sum{(\hat{Y_{i}}-\bar{Y})^{2}}$: 회귀제곱합(SSR)<li>$\sum{(Y_{i}-\hat{Y_{i}})^{2}}$: 잔차제곱합(SSE)<li>총제곱합은 $X$ 관계없이 고정된 값이다. 따라서 회귀제곱합과 잔차제곱합은 반대로 움직인다.</ul><h2 id="자유도"><span class="mr-2">자유도</span><a href="#자유도" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>SST: $(n-1)$, $\bar{Y}$ 가 제약조건 1<li>SSE: $(n-p)$, $\hat{Y_{i}} = \hat{\beta_{0}}+\hat{\beta_{1}}X_{i, 1}+\hat{\beta_{2}}X_{i,2}+…+\hat{\beta_{p-1}}X_{i,p-1}$ 이다. $\hat{Y_{i}}$ 값을 구하기 위해서는 $\hat{\beta_{0}}, \hat{\beta_{1}}, …\hat{\beta_{p-1}}$ 의 $\hat{\beta_{i}}$ $p$ 개를 알아야 한다. 따라서 제약조건도 $p$ 개다. 자유도는 $(n-p)$ 가 된다.<li>SSR: $(n-1)-(n-p) = (p-1)$ 이다.</ul><h2 id="분산분석표anova-table"><span class="mr-2">분산분석표(ANOVA Table)</span><a href="#분산분석표anova-table" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img width="1088" alt="Screen Shot 2022-01-11 at 16 01 10" data-src="https://user-images.githubusercontent.com/83487073/148896018-e13481c0-c0b6-4dd2-8fa1-b481d9883cf9.png" data-proofer-ignore></p><p>[이미지 출처: 부산대학교 김충락 교수님의 R을 이용한 통계학개론 - 07_회귀분석.pdf 30페이지]</p><h2 id="f비"><span class="mr-2">F비</span><a href="#f비" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>F비 값 $\frac{MSR}{MSE}$ 은 다중회귀모형의 유의미성을 검정할 때 사용한다. 귀무가설이 맞다는 전제 하에, F비 값은 $F(p-1, n-p)$ 를 따른다.</p><p>$F statistic = \frac{MSR}{MSE} \sim F(p-1, n-p)$</p><h2 id="다중회귀모형의-유의성-검정"><span class="mr-2">다중회귀모형의 유의성 검정</span><a href="#다중회귀모형의-유의성-검정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>다중회귀모형이 의미가 있는지 없는지 검정한다.</p><h2 id="h_0-hatbeta_1--hatbeta_2--hatbeta_p-1--0-다중회귀모형이-의미가-없다"><span class="mr-2">$H_{0}: \hat{\beta_{1}} = \hat{\beta_{2}}= … \hat{\beta}_{p-1} = 0$ (다중회귀모형이 의미가 없다)</span><a href="#h_0-hatbeta_1--hatbeta_2--hatbeta_p-1--0-다중회귀모형이-의미가-없다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="h_a-hatbeta_i-중-최소한-하나는-0-이-아니다-모형이-의미가-있다"><span class="mr-2">$H_{a}: \hat{\beta_{i}}$ 중 최소한 하나는 $0$ 이 아니다 (모형이 의미가 있다)</span><a href="#h_a-hatbeta_i-중-최소한-하나는-0-이-아니다-모형이-의미가-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>귀무가설 기각하려면 $F$ 비 값이 매우 커야 한다.</p><p>$F$ 비 값은 $\frac{MSR}{MSE}$ 이다.</p><p>$F$ 비 값이 커지려면 $MSR$이 커져야 한다. $MSR$이 커지려면 $SSR$ 이 커져야 한다. $\Rightarrow$ $F$ 비 값이 커지려면 $SSR$ 이 매우 커져야 한다.</p><p>한편 $F$ 비 값이 커지려면 $MSE$ 는 작아져야 한다. $MSE$ 가 작아지려면 $SSE$ 가 작아져야 한다. $\Rightarrow$ $F$ 비 값이 커지려면 $SSE$ 가 매우 작아져야 한다.</p><h2 id="종합하면-f비-값이-커져서-귀무가설을-기각모형이-의미가-있다-하려면-ssr-값이-커지고-sse-값이-작아져야-한다"><span class="mr-2">종합하면, $F$비 값이 커져서 귀무가설을 기각(모형이 의미가 있다) 하려면 $SSR$ 값이 커지고 $SSE$ 값이 작아져야 한다.</span><a href="#종합하면-f비-값이-커져서-귀무가설을-기각모형이-의미가-있다-하려면-ssr-값이-커지고-sse-값이-작아져야-한다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><h1 id="r에서-다중회귀분석">R에서 다중회귀분석</h1><h2 id="r-내장-stackloss-데이터"><span class="mr-2">R 내장 stackloss 데이터</span><a href="#r-내장-stackloss-데이터" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># 다중회귀분석 </span><span class="w">
</span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stackloss</span><span class="w"> </span><span class="c1"># R 내장 stackloss 데이터 </span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="c1"># air flow, water temp, acid.conc, stackloss 4개 변수의 데이터로 구성된 데이터셋이다. </span><span class="w">
</span></pre></table></code></div></div><p><img width="344" alt="Screen Shot 2022-01-11 at 16 16 53" data-src="https://user-images.githubusercontent.com/83487073/148897813-7593b423-b9dd-4ca9-9211-d6d6ed0603f2.png" data-proofer-ignore></p><h2 id="반응변수와-설명변수-설정"><span class="mr-2">반응변수와 설명변수 설정</span><a href="#반응변수와-설명변수-설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 반응변수 </span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">stack.loss</span><span class="w">
</span><span class="n">x1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">Air.Flow</span><span class="w">
</span><span class="n">x2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">Water.Temp</span><span class="w">
</span><span class="n">x3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dt</span><span class="o">$</span><span class="n">Acid.Conc.</span><span class="w">
</span></pre></table></code></div></div><h2 id="데이터관측치-행렬-x-생성"><span class="mr-2">데이터(관측치) 행렬 X 생성</span><a href="#데이터관측치-행렬-x-생성" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 데이터 행렬 </span><span class="w">
</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 열벡터 x1, x2, x3를 열로 써서 묶어라 (행렬로 변환)</span><span class="w">
</span></pre></table></code></div></div><h2 id="x1-x2-x3-변수-사이-관계-모아보기"><span class="mr-2">x1, x2, x3 변수 사이 관계 모아보기</span><a href="#x1-x2-x3-변수-사이-관계-모아보기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 각 변수 사이 관계 산점도로 살펴보기 </span><span class="w">
</span><span class="n">pairs</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="w"> 
</span></pre></table></code></div></div><p>x1, x2, x3 중 서로 상관관계 있어 보이는 변수들은 y에 대한 설명이 중복될 수 있다.</p><p>따라서 스캐터 플롯으로 결과를 보고, 서로 상관관계 있어보이는 x 변수들은 모형에 둘 중 하나만 넣거나 둘 다 빼는 걸 고려해 볼 수 있다.</p><p><img width="778" alt="Screen Shot 2022-01-11 at 16 19 32" data-src="https://user-images.githubusercontent.com/83487073/148898179-ab5847e4-4cdb-4508-8491-727a1035a3ed.png" data-proofer-ignore></p><h2 id="다중선형회귀모형에-반응변수와-설명변수-회귀시키기"><span class="mr-2">다중선형회귀모형에 반응변수와 설명변수 회귀시키기</span><a href="#다중선형회귀모형에-반응변수와-설명변수-회귀시키기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># 다중선형회귀모형 </span><span class="w">
</span><span class="n">stackfit</span><span class="o">&lt;-</span><span class="n">lm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">+</span><span class="n">x3</span><span class="p">)</span><span class="w"> </span><span class="c1"># 반응변수~ 설명변수 1,2,3</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p>plot(회귀모형) 명령은 아래 4개 플롯을 제공한다.</p><ul><li>Residual vs Fitted<li>Normal Q-Q plot<li>Standardized Residual vs Fitted<li>Residuals vs Leverage</ul><h3 id="residual-vs-fitted"><span class="mr-2">Residual vs Fitted</span><a href="#residual-vs-fitted" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="783" alt="Screen Shot 2022-01-11 at 16 33 37" data-src="https://user-images.githubusercontent.com/83487073/148899956-aa75f7e4-df9e-40a1-8aa6-8e8af3fadace.png" data-proofer-ignore></p><p>Residual vs Fitted plot 은 $\hat{y}$ 값 별 잔차를 보여준다.</p><p>그래프에서 $y$ 축이 잔차 크기를 나타낸다. 잔차 크기가 $-2$ 에서 $2$ 를 넘어서면 아웃라이어 값이라고 본다.</p><h3 id="normal-q-q-plot"><span class="mr-2">Normal Q-Q plot</span><a href="#normal-q-q-plot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="788" alt="Screen Shot 2022-01-11 at 16 36 00" data-src="https://user-images.githubusercontent.com/83487073/148900254-62cb0a1a-94ef-46ab-b54d-4ecc03e799de.png" data-proofer-ignore></p><p>Normal Q-Q plot 은 잔차의 표본분포가 정규분포를 따르는지 보여준다.</p><p>잔차는 이론적으로 정규분포 $N(0, \sigma^{2})$ 을 따른다고 했었다.</p><p>이 그래프는 잔차가 정규성 가정을 만족하는지 보여준다.</p><p>선형에 가까울 수록 정규분포에 가까운 것이다.</p><h3 id="standardized-residual-vs-fitted"><span class="mr-2">Standardized Residual vs Fitted</span><a href="#standardized-residual-vs-fitted" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="786" alt="Screen Shot 2022-01-11 at 16 37 45" data-src="https://user-images.githubusercontent.com/83487073/148900472-b525aab7-3131-4766-8232-a0e53044c1c2.png" data-proofer-ignore></p><p>Standardized Residual vs Fitted plot 은 $\hat{y}$ 값 별 표준화 잔차를 보여준다.</p><p>$y$ 축이 표준화 잔차 크기를 나타낸다.</p><p>잔차를 표준화 시키는 방법은 아래와 같다.</p><p>$r$ 을 잔차라고 칭할 때,</p><p>표준화 잔차 $= \frac{\vert{r}\vert{}}{잔차의 표준오차}$</p><p>표준화 잔차 절댓값이 $0$ 기준으로 $2, 2.5,$ 또는 $3$ 을 넘어서는 fitted value를 아웃라이어 값이라고 본다.</p><p>위 그래프는 표준화 잔차에 제곱근을 취했다. 따라서 $\sqrt{표준화잔차}$ 가 대략 $1 \sim 1.2$ 인 값들이 아웃라이어 값들이다.</p><h3 id="residuals-vs-leverage"><span class="mr-2">Residuals vs Leverage</span><a href="#residuals-vs-leverage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="788" alt="Screen Shot 2022-01-11 at 16 43 09" data-src="https://user-images.githubusercontent.com/83487073/148901133-8b222515-617c-4153-930b-521648755c02.png" data-proofer-ignore></p><p>그래프 X 축(Leverage)은 설명변숫값이 평균에서 떨어져 있는 정도를 의미한다. 레버리지가 클 수록 평균에서 멀리 떨어져 있다는 뜻이다.</p><p>한편 그래프 상에 붉은 점선으로 된 컨투어 플롯이 쿡 거리를 나타낸다. 맨 가운데 붉은 실선에서 멀어지면 멀어질 수록 쿡 거리가 먼 것(쿡 통계량이 큰 것) 이다. $21, 4, 1$ 이 다른 값들보다 쿡 통계량이 큰 값들이다. 한편 $1$ 과 $21$ 관측치는 레버리지가 크고, 잔차도 상당히 큰 값들이다. $4$ 관측치는 레버리지는 작지만 잔차가 큰 값이다.</p><ul><li>쿡 통계량: $\hat{\beta}$ 값에 유독 영향 많이 미치는 관측치가 뭔지 알려주는 척도다.</ul><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 추정 결과 요약 </span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="584" alt="Screen Shot 2022-01-11 at 16 53 39" data-src="https://user-images.githubusercontent.com/83487073/148902532-d9724126-86e0-4b62-b2f1-c4dd33b2a16a.png" data-proofer-ignore></p><p>회귀계수 검정 결과를 볼 때, 이 회귀모형은 사실상</p><p>$Y = \hat{\beta_{0}} + \hat{\beta_{1}}X_{1}+\hat{\beta_{2}}X_{2}$ 와 같다. $\hat{\beta_{3}}$ 는 통계적 관점에서 볼 때 의미가 없었다.</p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 분산분석표 </span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="506" alt="Screen Shot 2022-01-11 at 16 56 39" data-src="https://user-images.githubusercontent.com/83487073/148902893-db72e6d3-0789-4fb5-8466-47b846221d2b.png" data-proofer-ignore></p><p>위 분산분석표는 (x1, residuals), (x2, residuals), (x3, residuals) 해서 각각 F비를 계산하고 각 변수의 회귀계수가 유의한지 F 분포를 이용해 검정, F비의 p-value 를 나타낸 결과다.</p><p>summary() 결과와 마찬가지로 변수 x1과 x2가 통계적으로 유의미하게 나왔다.</p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀모형의 잔차제곱합 </span><span class="w">
</span><span class="n">deviance</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">  </span><span class="c1"># stackfit은 y_hat 값들이다. sum(y-y_hat)^{2} 즉 잔차제곱합 계산한다.</span><span class="w">
</span></pre></table></code></div></div><p>178.83</p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀모형의 총제곱합 </span><span class="w">
</span><span class="n">deviance</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="c1"># lm(y~1) 은 y 평균 y_bar 를 의미한다. 따라서 이 명령은 sum(y-y_bar)^{2} 총제곱합을 의미한다. </span><span class="w">
</span></pre></table></code></div></div><p>2069.238</p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀모형의 모든 잔차 </span><span class="w">
</span><span class="n">residuals</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="547" alt="Screen Shot 2022-01-11 at 17 06 00" data-src="https://user-images.githubusercontent.com/83487073/148904105-85c57210-b14c-402b-82a8-a9c2fd6f852e.png" data-proofer-ignore></p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀계숫값들의 분산-공분산 행렬 </span><span class="w">
</span><span class="n">vcov</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="512" alt="Screen Shot 2022-01-11 at 17 07 57" data-src="https://user-images.githubusercontent.com/83487073/148904363-b22f87ea-c4f1-4a34-af9b-4f4763096d76.png" data-proofer-ignore></p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 회귀계숫값들 </span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="400" alt="Screen Shot 2022-01-11 at 17 08 35" data-src="https://user-images.githubusercontent.com/83487073/148904435-f64ea908-f618-4cdc-893f-2f63a61cca15.png" data-proofer-ignore></p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># step: 실질적으로 y 설명하는 독립변수만 남겨서 출력하는 명령 </span><span class="w">
</span><span class="n">step</span><span class="p">(</span><span class="n">stackfit</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="544" alt="Screen Shot 2022-01-11 at 17 14 49" data-src="https://user-images.githubusercontent.com/83487073/148905281-a65bd6bd-ce6d-4062-91c8-2cc2f6ce11c5.png" data-proofer-ignore></p><p>intercept, x1, x2 의 회귀계수만 남아서 출력되었다.</p><p>이는 분산분석표에서 관찰했던 것과 같다.</p><h1 id="2차원-평면에서-그림-그리기">2차원 평면에서 그림 그리기</h1><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># 데이터셋 로드 </span><span class="w">
</span><span class="n">faithful</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">faithful</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p><img width="187" alt="Screen Shot 2022-01-11 at 17 24 53" data-src="https://user-images.githubusercontent.com/83487073/148906770-082f0745-f17d-456e-96a4-2bf7eb35c736.png" data-proofer-ignore></p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">faithful</span><span class="o">$</span><span class="n">eruptions</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">faithful</span><span class="o">$</span><span class="n">waiting</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="c1"># 선형 상관관계 있는 것으로 보인다. </span><span class="w">
</span><span class="n">cor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="c1"># 피어슨 상관계숫값 0.90 으로 높은 선형상관관계가 나타난다. </span><span class="w">
</span></pre></table></code></div></div><p><img width="781" alt="Screen Shot 2022-01-11 at 17 26 13" data-src="https://user-images.githubusercontent.com/83487073/148906956-30310ad9-ef44-4286-8427-3a36f9bda0ae.png" data-proofer-ignore></p><p>피어슨 상관계숫값: 0.90</p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># X축, Y축, 제목 라벨 부여하기 </span><span class="w">
</span><span class="c1"># x축, y축 값 제한 설정하기 </span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Eruptions'</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Waiting'</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="s1">'Faithful Data'</span><span class="p">,</span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">30</span><span class="p">,</span><span class="m">100</span><span class="p">))</span><span class="w">
</span></pre></table></code></div></div><p><img width="784" alt="Screen Shot 2022-01-11 at 17 27 18" data-src="https://user-images.githubusercontent.com/83487073/148907145-f84357e8-43f2-4c14-b9e6-fc4dffcfcd31.png" data-proofer-ignore></p><div class="language-R highlighter-rouge"><div class="code-header"> <span data-label-text="R"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="c1"># 데이터 별로 구분해서 나타내기 </span><span class="w">
</span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">136</span><span class="p">]</span><span class="w">
</span><span class="n">x2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="m">137</span><span class="o">:</span><span class="m">272</span><span class="p">]</span><span class="w">
</span><span class="n">y1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">136</span><span class="p">]</span><span class="w">
</span><span class="n">y2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">y</span><span class="p">[</span><span class="m">137</span><span class="o">:</span><span class="m">272</span><span class="p">]</span><span class="w">

</span><span class="n">plot</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">),</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">),</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s1">'n'</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s1">'Eruptions'</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s1">'Waiting'</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s1">'Faithful Data'</span><span class="p">)</span><span class="w"> </span><span class="c1"># type='n'은 '점을 찍지 마라'는 명령이다. </span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'salmon'</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'cyan'</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">y1</span><span class="o">~</span><span class="n">x1</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'salmon'</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">y2</span><span class="o">~</span><span class="n">x2</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s1">'cyan'</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">y</span><span class="o">~</span><span class="n">x</span><span class="p">))</span><span class="w">
</span></pre></table></code></div></div><p><img width="781" alt="Screen Shot 2022-01-11 at 17 28 44" data-src="https://user-images.githubusercontent.com/83487073/148907362-fc80edef-69d8-4df9-9069-f011fab94381.png" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/statistics/'>Statistics</a>, <a href='/categories/r/'>R</a>, <a href='/categories/data-science/'>Data Science</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/statistics/" class="post-tag no-text-decoration" >Statistics</a> <a href="/tags/r/" class="post-tag no-text-decoration" >R</a> <a href="/tags/data-science/" class="post-tag no-text-decoration" >Data Science</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%ED%86%B5%EA%B3%84%ED%95%99%EA%B0%9C%EB%A1%A0+%EB%B3%B5%EC%8A%B5%5D+%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+%EA%B0%9C%EB%85%90%2C+%EC%A2%85%EB%A5%98%2C+%EB%8B%A8%EC%88%9C%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D%2C+%EB%8B%A4%EC%A4%91%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+-+der+Wille+zur+Macht&url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fregression%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%ED%86%B5%EA%B3%84%ED%95%99%EA%B0%9C%EB%A1%A0+%EB%B3%B5%EC%8A%B5%5D+%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+%EA%B0%9C%EB%85%90%2C+%EC%A2%85%EB%A5%98%2C+%EB%8B%A8%EC%88%9C%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D%2C+%EB%8B%A4%EC%A4%91%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+-+der+Wille+zur+Macht&u=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fregression%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fregression%2F&text=%5B%ED%86%B5%EA%B3%84%ED%95%99%EA%B0%9C%EB%A1%A0+%EB%B3%B5%EC%8A%B5%5D+%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+%EA%B0%9C%EB%85%90%2C+%EC%A2%85%EB%A5%98%2C+%EB%8B%A8%EC%88%9C%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D%2C+%EB%8B%A4%EC%A4%91%EC%84%A0%ED%98%95%ED%9A%8C%EA%B7%80%EB%B6%84%EC%84%9D+-+der+Wille+zur+Macht" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="tigerkey10/bioinfo.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/classifier/">[알고리즘/지도학습] 로지스틱 회귀, 서포트벡터 머신, 나이브 베이즈 알고리듬, 분류모형 별 성능 비교</a><li><a href="/posts/regressor/">[알고리즘/지도학습] 회귀문제 - 선형회귀, 의사결정회귀나무, 의사결정회귀나무 앙상블(그래디언트 부스트)</a><li><a href="/posts/boosting/">[알고리즘/지도학습] 앙상블 알고리즘-부스팅(에이다 부스트, 그래디언트 부스트)</a><li><a href="/posts/ensemble/">[알고리즘/지도학습] 앙상블 알고리즘-취합(다수결 투표, 배깅, 랜덤포레스트)</a><li><a href="/posts/decision_tree/">[알고리즘/지도학습] 의사결정나무(Decision Tree) 알고리듬</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/regression_analysis/"><div class="card-body"> <em class="small" data-ts="1633273200" data-df="YYYY-MM-DD" > 2021-10-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 단순 선형회귀분석, 다중 선형회귀분석</h3><div class="text-muted small"><p> 아래 글은 부산대학교 송태호 교수님의 ‘마케팅 애널리틱스’ 수업을 듣고 복습한 뒤, 학습 내용을 제 언어로 바꾸어 기록한 글 입니다. 단순 선형회귀분석 정의 : 독립변수 $x$ 와 종속변수 $y$ 사이 관계를 가장 잘 설명하는 모형 찾기 선형회귀식 $\hat{y} = b_{0} + b_{1}x_{i}$ 선형회귀식. 선형 모...</p></div></div></a></div><div class="card"> <a href="/posts/data_visualization/"><div class="card-body"> <em class="small" data-ts="1624201200" data-df="YYYY-MM-DD" > 2021-06-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[데이터시각화/파이썬] matplotlib 을 이용해서 그래프 그리기</h3><div class="text-muted small"><p> 공부 중인 내용을 기록으로 남겨, 나중에 다시 빠르게 ‘불러오기’ 위한 저장소. 데이터 시각화 하기 데이터사이언스 공부 기반이 되는 필수 수학 공부 중 만난 시각화 방법들을 기록한다. 사용한 라이브러리 : matplotlib import matplotlib as plt # plt라는 약어로 불러오기 위함. # 지금 시점에서 나는 스타...</p></div></div></a></div><div class="card"> <a href="/posts/percentage_recap/"><div class="card-body"> <em class="small" data-ts="1624287600" data-df="YYYY-MM-DD" > 2021-06-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률론] 확률론 기초 복습</h3><div class="text-muted small"><p> [06-22-2021] 데이터사이언스스쿨 - 6장 확률론 기초 복습 확률변수 표본을 실수 데이터로 바꿔서 현실에 보내주는 것 1 동전 앞 뒤 중 하나 뽑기 : 베르누이 확률변수 2 트펌프 카드 뭉치에서 한 장 뽑기 : 카테고리 확률변수 3 동전 두변 던진 결과 : 다변수 확률변수 4 약속날짜가 31일인가 아닌가 : 베르누이 확률변수...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mapping_type/" class="btn btn-outline-primary" prompt="이전 글"><p>[2021 인공지능전문가 교육과정 복습] 매핑, 딕셔너리, 집합, any(), all()</p></a> <a href="/posts/stack_que_deck/" class="btn btn-outline-primary" prompt="다음 글"><p>[2021 인공지능전문가 교육과정 복습] 스택, 큐, 덱, 우선순위 큐</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
