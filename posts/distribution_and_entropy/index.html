<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="공부 중인 내용을 정리한 글" /><meta property="og:description" content="공부 중인 내용을 정리한 글" /><link rel="canonical" href="https://kibeomkim.me/posts/distribution_and_entropy/" /><meta property="og:url" content="https://kibeomkim.me/posts/distribution_and_entropy/" /><meta property="og:site_name" content="der Wille zur Macht" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-11T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산" /><meta name="google-site-verification" content="1CLBUlwAX10LXrW4RzkPuaeWtey34c3dyngs14cKrCw" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-08-15T00:00:00+09:00","datePublished":"2021-08-11T00:00:00+09:00","description":"공부 중인 내용을 정리한 글","headline":"[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산","mainEntityOfPage":{"@type":"WebPage","@id":"https://kibeomkim.me/posts/distribution_and_entropy/"},"url":"https://kibeomkim.me/posts/distribution_and_entropy/"}</script><title>[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산 | der Wille zur Macht</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="der Wille zur Macht"><meta name="application-name" content="der Wille zur Macht"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/emoge.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">der Wille zur Macht</a></div><div class="site-subtitle font-italic">10,000 Hours</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://github.com/tigerkey10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkb1004tom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[수학/엔트로피] 엔트로피, 결합엔트로피, 조건부엔트로피, 크로스엔트로피, 쿨백-라이블러 발산</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1628607600" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-08-11 </em> </span> <span> 업데이트 <em class="" data-ts="1628985600" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-08-15 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6720 단어"> <em>37 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="엔트로피">엔트로피</h1><h2 id="정의"><span class="mr-2">정의</span><a href="#정의" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="확률분포에서-나온-표본-1개가-특정-표본인지-추려내기-위해-필요한-평균-질문-갯수정보량"><span class="mr-2">확률분포에서 나온 표본 1개가 특정 표본인지 추려내기 위해 필요한 평균 질문 갯수(정보량)</span><a href="#확률분포에서-나온-표본-1개가-특정-표본인지-추려내기-위해-필요한-평균-질문-갯수정보량" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>분포의 불확실성<li>분포에서 새롭게 얻을 수 있는 정보의 양 (=놀람의 정도)<li>분포의 분산 정도<li>엔트로피 단위 : 비트</ul><h2 id="표기"><span class="mr-2">표기</span><a href="#표기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>H<li>수학적 정의는 확률변수를 입력으로 받는 범함수다.</ul><p>이산확률변수</p><p>$H[Y] = -\sum_{i=1}^{k} p(y_{k})\log_{2}{p(y_{k})}$</p><p>연속확률변수</p><p>$H[Y] = -\int p(y)\log_{2} p(y) dy$</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">ent_values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">xx</span> <span class="p">:</span> 
    <span class="k">if</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span> 
        <span class="n">ent_values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span> <span class="p">:</span> 
        <span class="n">ent_value</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">ent_values</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ent_value</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">ent_values</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'엔트로피 $H[Y]$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="554" alt="Screen Shot 2021-08-15 at 10 01 58" data-src="https://user-images.githubusercontent.com/83487073/129463738-3736694c-5a6f-480c-8cdf-59513dbe8bdc.png" data-proofer-ignore></p><h2 id="사이파이-엔트로피-계산-코드"><span class="mr-2">사이파이 엔트로피 계산 코드</span><a href="#사이파이-엔트로피-계산-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></table></code></div></div><p>p 는 엔트로피를 계산할 확률분포다.</p><hr /><h1 id="엔트로피의-성질">엔트로피의 성질</h1><ul><li>엔트로피 최솟값은 0 이다.</ul><p>분포 분산정도가 극단적으로 낮은 경우, 엔트로피 값이 0 나올 수 있다.</p><ul><li>분포 분산 정도와 엔트로피값 크기는 정비례 한다.</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>

<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">x1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s">'Y=0'</span><span class="p">,</span> <span class="s">'Y=1'</span><span class="p">,</span> <span class="s">'Y=2'</span><span class="p">,</span> <span class="s">'Y=3'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'$H[Y] = 1.75$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">x2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s">'Y=0'</span><span class="p">,</span> <span class="s">'Y=1'</span><span class="p">,</span> <span class="s">'Y=2'</span><span class="p">,</span> <span class="s">'Y=3'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'H[Y] = 0'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">x3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s">'Y=0'</span><span class="p">,</span> <span class="s">'Y=1'</span><span class="p">,</span> <span class="s">'Y=2'</span><span class="p">,</span> <span class="s">'Y=3'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'$H[Y] = 2$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'분산정도가 작을 수록 엔트로피가 작아진다'</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mf">1.04</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="559" alt="Screen Shot 2021-08-14 at 22 06 21" data-src="https://user-images.githubusercontent.com/83487073/129447242-1a734e76-5bc4-4084-a48b-9b7c70acd586.png" data-proofer-ignore></p><h2 id="위-그림에서"><span class="mr-2">위 그림에서</span><a href="#위-그림에서" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>두번째 분포는 표본 얻었을 때 Y=0이 나올 가능성이 100% 다. 이 분포에서 앞으로 어떤 정보를 얻어도 놀랍지 않을 것이다. 왜냐하면 불 보듯 뻔하게 1이 나올 것이기 때문이다. 따라서 두번째 분포는 새롭게 얻게 될 정보량(엔트로피)가 0 이다.</p><p>또한 두번째 분포는 분산 정도 또한 극단적으로 낮음을 볼 수 있다. 분산 정도가 작으면 분포의 엔트로피값도 작다.</p><h2 id="한편"><span class="mr-2">한편</span><a href="#한편" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>세번째 분포는 범줏값 0~3이 나올 확률이 모두 같다. 따라서 내가 이 분포에서 표본을 얻으려 할 경우, 뭐가 나올지 전혀 알 수 없다. 따라서 이 분포에서 데이터를 1개 얻을 경우, 그 데이터는 귀중한 가치를 지닌 ‘정보’ 가 된다. 이후에 얻는 데이터 하나하나도 정보가치가 충분할 것이다. 따라서 이 분포는 새롭게 얻게 될 정보량이 많은 분포라고 생각할 수 있다. 엔트로피는 이런 경우 가장 커진다.</p><p>또 세번째 분포 분산정도 또한 매우 높음을 볼 수 있다. 분산 정도가 클 수록 분포의 엔트로피 값도 크다.</p><hr /><h1 id="가변길이-인코딩과-고정길이-인코딩">가변길이 인코딩과 고정길이 인코딩</h1><h2 id="가변길이-인코딩"><span class="mr-2">가변길이 인코딩</span><a href="#가변길이-인코딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>인코딩 : 표본 1개에 대한 질문-응답 결과와 같았다.<li>가변길이 인코딩 : 확률분포 확률값들에 따라 질문하는, 가장 효율적인 질문 전략</ul><p>가변길이 인코딩 예)</p><p>$p = [0.5, 0.25, 0.125, 0.125]$ 라는 분포가 있다고 가정해보자.</p><p><img width="555" alt="Screen Shot 2021-08-14 at 22 28 08" data-src="https://user-images.githubusercontent.com/83487073/129447780-6ddf3314-7084-4036-ad8f-edbe725bb4da.png" data-proofer-ignore></p><p>이 분포를 갖는 확률변수에서 뭔진 모르겠지만 어떤 표본 하나가 나온다고 하자.</p><p>이 표본이 뭔지 어떻게 추려낼 것인가?</p><p>질문을 던지면 된다.</p><p>예를 들어 ‘나온 표본은 A’인가? , ‘B인가?’ 등등으로 물을 수 있다. 하나의 질문에 대해 YES 나 NO로 대답해가면서 이번에 나온 표본이 뭔지 추릴 수 있다.</p><p>가변길이 인코딩은 이 ‘질문 방식’으로 생각할 수 있다.</p><p>가변길이 인코딩에서는 기본적으로 각 표본마다 할당된 확률값에 기초해 질문을 던진다.</p><p>예를 들어 A가 0.5로 가장 확률이 높다. 표본 하나를 얻었을 때 그게 A일 확률이 가장 높다. 그러면 첫 질문으로 A인가? 아니면 BCD인가? 이렇게 질문을 던진다.</p><p>그리고 만약 A이면 A를 추려낸 것이고, A가 아니면 다시 두번째로 확률높은 B인가? 를 질문한다.</p><p>이런식으로 C,D까지 추려낼 수 있다. 그 후 각 질문에 대한 답변에 기초해 각 문자를 이진수로 인코딩할 수 있다.</p><p>예를 들어 A는 첫 질문에서 YES라고 답한 후 추려졌다.</p><p>YES = 0, NO = 1 로 생각하면, A는 곧 0으로 인코딩 된다.</p><p>나머지 알파벳도 마찬가지다.</p><p><img width="1025" alt="Screen Shot 2021-08-14 at 22 42 33" data-src="https://user-images.githubusercontent.com/83487073/129448184-0603fc31-d018-4d1c-88dd-ca40695ddbd4.png" data-proofer-ignore></p><p>A는 0으로 인코딩 되었는데, 한 자리다. 이는 비트 하나, 그러니까 질문 1개 를 나타낸다.</p><p>D는 111로 인코딩 되었는데, 세 자리다. 이는 비트 셋, 그러니까 질문 3개를 나타낸다.</p><ul><li>참고) 한 글자에 인코딩 된 이진수는 다른 글자에 인코딩 된 이진수의 접두어가 될 수 없다.</ul><h2 id="고정길이-인코딩"><span class="mr-2">고정길이 인코딩</span><a href="#고정길이-인코딩" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>모든 표본이 균등분포에서 나왔다고 전제한다.<li>어떤 표본이 더 나오고, 덜 나오고 없다.</ul><p>모든 표본이 나올 가능성이 같으므로, 어떤 표본을 먼저 추려내고, 늦게 추려내고 할 수 없다. 따라서 다른 방법으로 추려내야 한다.</p><p>이때 표본을 추려내는 최적의 질문전략은 다음과 같다.</p><p>‘ABCD’ 이면, 절반/절반으로 나누어 표본을 추려내고, 다시 거기서 절반/절반을 나누어 표본을 추려낸다.</p><p>‘AB’, ‘CD’</p><p>‘A’, ‘B’, ‘C’, ‘D’ 이렇게 나누는 식이다.</p><p><img width="990" alt="Screen Shot 2021-08-15 at 10 08 25" data-src="https://user-images.githubusercontent.com/83487073/129463819-542d04e0-bedc-485a-bbe2-317bb18c5d32.png" data-proofer-ignore></p><p>위 그림과 같다.</p><p>이렇게 표본을 추려내면 모든 표본에 대해 질문횟수가 같다.</p><p>YES = 0, NO = 1로 두고, 각 알파벳을 질문 결과에 따라 인코딩 하면</p><p>A = 00</p><p>B = 01</p><p>C = 10</p><p>D = 11</p><p>이렇게 인코딩할 수 있는데, 이게 고정길이 인코딩 방식이다.</p><hr /><h1 id="엔트로피---가변길이-인코딩-사이-관계">엔트로피 - 가변길이 인코딩 사이 관계</h1><ul><li>엔트로피 값 = 가변길이 인코딩 했을 때 표본 1개당 평균 정보량</ul><p>예)</p><p>어떤 문서가 있다. 이 문서는 A,B,C,D,E,F,G,H 로 구성되어 있다. 각 알파벳이 등장할 확률은 다음과 같다.</p><p>$P = [1/2, 1/4, 1/8, 1/16, 1/64, 1/64, 1/64, 1/64]$</p><p>이 문서 알파벳들을 전부 가변길이 인코딩 할 때, 알파벳 1개 당 평균 비트 수는?</p><p>답)</p><p>먼저, 이 문서는 K = 8 인 카테고리 확률변수에서 나온 표본들을 모아놓은 것과 같다.</p><p>예컨대 문서가</p><p>‘AAAAABAAAACDAAAADABBBCCBBABBCABDABADADACBABACBADAABAACAADAABDCDCCABADCAACABABBAAAACDABBBDABCAAADDBBAABAAACAADADBCACBADBABAAABAAAABACABBBABAABCBABAAABACAACAACAAADABBBAAABDCDACDAAAADAAAABDAABABCDABBBDAA’</p><p>이런 식 이라면, 이건 K = 8인 카테고리 확률변수를 200번 시뮬레이션 해서 얻어낸 데이터 집합이다.</p><p>이 문서가 결국 카테고리확률변수의 표본이라는 게 핵심이다.</p><p>앞에서 비트 수는 질문갯수와 같았다.</p><p>가변길이 인코딩 했을 때 알파벳 1개 당 평균 비트 수는 :</p><p>확률변수 확률분포에 따라 질문 던지고 각 표본 추려냈을 때, 표본 1개 당 평균 질문 갯수와 같다.</p><p><img width="875" alt="Screen Shot 2021-08-15 at 10 45 45" data-src="https://user-images.githubusercontent.com/83487073/129464350-acb89265-b3ca-4724-916d-b1d8f283588c.png" data-proofer-ignore></p><p><img width="785" alt="Screen Shot 2021-08-15 at 10 46 19" data-src="https://user-images.githubusercontent.com/83487073/129464360-7da80dc6-b07b-4761-a2bd-6a4874b01041.png" data-proofer-ignore></p><p>확률변수의 확률분포에 따라 질문을 던지고 각 표본값을 추려내 보았다.</p><p>그리고 각 질문에 대한 대답에 따라 각 표본을 이진수 인코딩 할 수 있었다.</p><p>A = 0</p><p>B = 10</p><p>C = 110</p><p>D = 1110</p><p>E = 111100</p><p>F = 111101</p><p>G = 111110</p><p>H = 111111</p><p>각 표본 1개 당 평균 비트 수는 각 확률분포값에 질문 갯수를 곱해서 가중합 한 것과 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">64</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
</pre></table></code></div></div><p>표본 1개 당 평균 비트 수(질문 갯수, 정보량) : 2.0</p><p>이 나온다.</p><h2 id="한편-1"><span class="mr-2">한편</span><a href="#한편-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>“엔트로피-가변길이 인코딩 간 관계”에 의해서 표본이 나온 분포의 엔트로피 값은 가변길이 인코딩 했을 때 표본 1개 당 평균 정보량(비트 수, 질문 갯수) 와 같았다.</p><p>따라서 A,B,C,… 표본이 나온 카테고리 확률분포의 엔트로피 값을 구하면, 표본 1개 당 평균 정보량을 구할 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">64</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>

<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">p</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'문서 : $k=8$ 인 카테고리 확률분포'</span><span class="p">)</span>
<span class="n">avg_info</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$k$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="p">[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'C'</span><span class="p">,</span><span class="s">'D'</span><span class="p">,</span><span class="s">'E'</span><span class="p">,</span><span class="s">'F'</span><span class="p">,</span><span class="s">'G'</span><span class="p">,</span><span class="s">'H'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'표본 1개 당 평균 정보량(=비트 수) : </span><span class="si">{</span><span class="n">avg_info</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'k=8인 카테고리 확률분포의 엔트로피 : </span><span class="si">{</span><span class="n">avg_info</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="562" alt="Screen Shot 2021-08-15 at 10 56 21" data-src="https://user-images.githubusercontent.com/83487073/129464521-31e6993f-5a49-4fbd-813a-c7adae86cef4.png" data-proofer-ignore></p><p>k=8인 카테고리 확률분포의 엔트로피 : 2.0</p><p>표본 1개 당 평균 정보량(=비트 수) : 2.0</p><p>이다. 확률분포의 엔트로피값과 표본 1개당 평균 질문갯수가 같음을 재확인할 수 있었다.</p><hr /><h1 id="지니불순도">지니불순도</h1><ul><li>엔트로피 대용으로 쓸 수 있는 값<li>지니불순도*2 는 엔트로피 값에 근사한다.</ul><p>$G[Y] = \sum_{k=1}^{k} P(y_{k})(1-P(y_{k}))$</p><p>엔트로피와 지니불순도 비교</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="n">G</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
<span class="n">H</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>
<span class="n">G2</span> <span class="o">=</span> <span class="p">[(</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p</span><span class="p">]</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'지니불순도'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'엔트로피'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'지니불순도와 엔트로피'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$P(Y=1)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">G2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'지니불순도 값 * 2'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'엔트로피'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'지니불순도*2 와 엔트로피'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$P(Y=1)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'엔트로피와 지니불순도 비교'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.007</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="557" alt="Screen Shot 2021-08-15 at 11 05 17" data-src="https://user-images.githubusercontent.com/83487073/129464640-e3085ab5-6dff-4cbf-87f3-2398a4937f8c.png" data-proofer-ignore></p><p>지니불순도 *2 를 하면 엔트로피값에 근사하는 것을 볼 수 있었다.</p><hr /><h1 id="결합엔트로피">결합엔트로피</h1><ul><li>결합확률분포의 엔트로피 (벡터 분포의 엔트로피)<li>일반적인 엔트로피와 성질이 같다. 분포 분산 정도가 작을 때 엔트로피 값 작아지고, 분산 정도가 클 때 엔트로피 값 커진다. 최솟값은 0이다.</ul><p>이산확률변수 X,Y</p><p>$H[X,Y] = -\sum_{i=1}^{K_{X}} \sum_{j=1}^{K_{Y}} p(x_{i}, y_{j})\log_{2}{p(x_{i}, y_{j})}$</p><p>연속확률변수 X,Y</p><p>$H[X,Y] = -\int_{x} \int_{y} p(x,y)\log_{2}{p(x,y)}dxdy$</p><hr /><h1 id="조건부엔트로피">조건부엔트로피</h1><ul><li>확률변수 X로 확률변수 Y를 예측할 수 있는 정도 나타낸다<li>X,Y 사이 상관관계, 독립 정도를 나타낸다.<li>$X = x_{i}$ 일 때 $Y$ 확률변수 조건부엔트로피를 $X$ 주변확률분포값을 가중치 삼아 가중합 한 것이다.</ul><h2 id="1-x--x_i-일-때-y-확률변수-조건부엔트로피"><span class="mr-2">1. $X = x_{i}$ 일 때 Y 확률변수 조건부엔트로피</span><a href="#1-x--x_i-일-때-y-확률변수-조건부엔트로피" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이산확률변수</p><p>$H[Y\vert X = x_{i}] = -\sum_{j=1}^{K_{Y}}p(y_{i}\vert x_{i})\log_{2}{p(y_{i} \vert x_{i})}$</p><p>연속확률변수</p><p>$H[Y\vert X = x] = -\int_{y}p(y\vert x)\log_{2}{p(y\vert x)}dx$</p><h2 id="2-조건부엔트로피"><span class="mr-2">2. 조건부엔트로피</span><a href="#2-조건부엔트로피" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이산확률변수 X,Y</p><p>$H[Y\vert X] = \sum_{i=1}^{K_{X}} p(x_{i})H[Y\vert X=x_{i}]$</p><p>연속확률변수 X,Y</p><p>$H[Y\vert X] = \int_{x} p(x)H[Y\vert X = x]dx$</p><h2 id="x로-y예측가능한-정도와-조건부엔트로피는-반대로-움직인다"><span class="mr-2">X로 Y예측가능한 정도와 조건부엔트로피는 반대로 움직인다</span><a href="#x로-y예측가능한-정도와-조건부엔트로피는-반대로-움직인다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>확률변수 X로 확률변수 Y 예측가능한 정도가 클 수록 조건부엔트로피 감소<li>확률변수 X로 확률변수 Y 예측가능한 정도가 작을 수록 조건부엔트로피 증가</ul><h2 id="조건부엔트로피-계산함수"><span class="mr-2">조건부엔트로피 계산함수</span><a href="#조건부엔트로피-계산함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">cond_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="p">:</span>
     <span class="n">cond_p1</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
     <span class="n">cond_p2</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
     <span class="n">ent1</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">cond_p1</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">ent2</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">cond_p2</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
     <span class="k">return</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">*</span><span class="n">ent1</span> <span class="o">+</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="n">df</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">*</span><span class="n">ent2</span>
</pre></table></code></div></div><h2 id="조건부엔트로피-활용-예"><span class="mr-2">조건부엔트로피 활용 예</span><a href="#조건부엔트로피-활용-예" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="데이터사이언스스쿨-연습문제-1021"><span class="mr-2">데이터사이언스스쿨 연습문제 10.2.1</span><a href="#데이터사이언스스쿨-연습문제-1021" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>문) 사이킷런 패키지 붓꽃 데이터에서, 꽃받침 길이와 꽃받침 폭 중 어떤 데이터가 붓꽃 종 분류(예측)에 더 도움이 되는가?</p><p>꽃받침 길이, 꽃받침 폭 데이터의 최솟값과 최댓값 사이를 0.05 간격 구간으로 나누어, 각각의 값을 분류 기준값으로 삼았을 때 조건부엔트로피값이 어떻게 변하는지 그래프로 그려서 설명해라.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">data</span><span class="p">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'species'</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">target</span>


<span class="k">def</span> <span class="nf">plot_cond_entropy</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">len_min</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>
    <span class="n">len_max</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>
    <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">len_min</span><span class="p">,</span> <span class="n">len_max</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">entropies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xx</span> <span class="p">:</span> 
        <span class="n">df</span><span class="p">[</span><span class="s">'X1'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">i</span> 
        <span class="n">pivot_table</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'X1'</span><span class="p">,</span> <span class="s">'species'</span><span class="p">]).</span><span class="n">size</span><span class="p">().</span><span class="n">unstack</span><span class="p">().</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">cond_p1</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">cond_p2</span> <span class="o">=</span> <span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">ent1</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">cond_p1</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ent2</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">cond_p2</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cond_entropy</span> <span class="o">=</span> <span class="p">(</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">*</span><span class="n">ent1</span> <span class="o">+</span> <span class="p">(</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nb">sum</span><span class="p">()</span><span class="o">/</span><span class="n">pivot_table</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="nb">sum</span><span class="p">())</span><span class="o">*</span><span class="n">ent2</span>
        <span class="n">entropies</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond_entropy</span><span class="p">)</span>

    <span class="n">ind</span> <span class="o">=</span> <span class="n">entropies</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">entropies</span><span class="p">))</span>
    <span class="n">optimized_value</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">xx</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">min_ent</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">entropies</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'최적해 : </span><span class="si">{</span><span class="n">optimized_value</span><span class="si">}</span><span class="s">, 최저 조건부엔트로피 : </span><span class="si">{</span><span class="n">min_ent</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">entropies</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">optimized_value</span><span class="p">,</span> <span class="n">min_ent</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s"> 기준값 별 조건부엔트로피 변화'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'꽃받침 길이 기준값'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'조건부엔트로피'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="1-꽃받침-길이를-기준값으로-삼았을-때"><span class="mr-2">1. 꽃받침 길이를 기준값으로 삼았을 때</span><a href="#1-꽃받침-길이를-기준값으로-삼았을-때" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="564" alt="Screen Shot 2021-08-15 at 12 21 39" data-src="https://user-images.githubusercontent.com/83487073/129465939-85820682-8e81-4278-834a-acb3f5150aaa.png" data-proofer-ignore></p><p>조건부엔트로피가 최소가 되는 꽃받침길이 기준값(최적해) 는 5.55 였다. 이때의 최저 조건부엔트로피값은 1.03 이었다.</p><h3 id="2-꽃받침-폭을-기준값으로-삼았을-때"><span class="mr-2">2. 꽃받침 폭을 기준값으로 삼았을 때</span><a href="#2-꽃받침-폭을-기준값으로-삼았을-때" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img width="572" alt="Screen Shot 2021-08-15 at 12 23 34" data-src="https://user-images.githubusercontent.com/83487073/129465963-557cb7ed-ffef-44db-a1d5-5516980fc066.png" data-proofer-ignore></p><p>조건부엔트로피가 최소가 되는 꽃받침 폭 기준값(최적해) 는 3.35 였다. 이때의 최저 조건부엔트로피값은 1.3 이었다.</p><h3 id="3-결론"><span class="mr-2">3. 결론</span><a href="#3-결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>꽃받침 길이를 기준값으로 썼을 때는 꽃받침 길이가 5.55cm 를 넘느냐/넘지 않느냐를 기준으로 종 분류가 가능했다.</p><p>꽃받침 폭을 기준값으로 썼을 때는 꽃받침 폭이 3.35를 넘느냐/넘지 않느냐를 기준으로 종 분류가 가능했다.</p><p>그리고 각 기준값에서, 조건부엔트로피값은 각각 1.03, 1.3 이었다.</p><p>조건부엔트로피 값은 ‘X 확률변수로 Y 확률변수를 예측할 수 있는정도’를 의미했다. 조건부엔트로피 값이 작을수록, X 확률변수로 Y 확률변수를 더 잘 예측할 수 있다. 꽃받침 길이를 기준값으로 삼았을 때 조건부엔트로피가 더 작았다. 꽃받침 길이가 꽃받침 폭 보다 ‘이 꽃의 종이 뭔지’ 더 잘 분류할 수 있는 특징값이라는 뜻이다.</p><h3 id="rightarrow-꽃받침-길이가-꽃받침-폭-보다-종-분류에-더-도움되는-특징값이다"><span class="mr-2">$\Rightarrow$ ‘꽃받침 길이’가 ‘꽃받침 폭’ 보다 종 분류에 더 도움되는 특징값이다!</span><a href="#rightarrow-꽃받침-길이가-꽃받침-폭-보다-종-분류에-더-도움되는-특징값이다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><hr /><h1 id="크로스엔트로피-교차엔트로피">크로스엔트로피 (교차엔트로피)</h1><p>https://hyunw.kim/blog/2017/10/26/Cross_Entropy.html</p><p>위 블로그의 크로스엔트로피 설명을 통해 이 개념을 확실히 이해할 수 있었다.</p><p>도움을 받아 내가 이해한 내용을 다시 정리하면,</p><p>크로스엔트로피란 다음과 같다.</p><hr /><h2 id="크로스엔트로피-정의--p-확률분포에서-나오는-표본이-뭔지-알아맞히기-위해-질문전략으로-q분포를-썼을-때-평균-질문-갯수"><span class="mr-2">크로스엔트로피 정의 : “P 확률분포에서 나오는 표본이 뭔지 알아맞히기 위해, 질문전략으로 Q분포를 썼을 때 평균 질문 갯수”</span><a href="#크로스엔트로피-정의--p-확률분포에서-나오는-표본이-뭔지-알아맞히기-위해-질문전략으로-q분포를-썼을-때-평균-질문-갯수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>정의 설명)</p><p>p 확률분포가 다음과 같다고 가정하자.</p><p>$p = [0.5, 0.25, 0.125, 0.125]$</p><p>p는 A,B,C,D 가 나오는 카테고리확률변수다.</p><p><img width="557" alt="Screen Shot 2021-08-15 at 12 36 06" data-src="https://user-images.githubusercontent.com/83487073/129466177-4a463aab-115e-4203-bcfe-04ee449b3d35.png" data-proofer-ignore></p><p>여기서 어떤 임의의 표본이 하나 나올 때 마다, 내가 얻은 표본이 뭔지 추려내기 위한 질문을 해보자.</p><p>가변길이 인코딩 파트에 기록했던 것 처럼, 가장 효율적 방식으로 P에서 나온 표본을 추려내기 위한 질문을 하면 다음과 같다.</p><p><img width="956" alt="Screen Shot 2021-08-15 at 12 42 20" data-src="https://user-images.githubusercontent.com/83487073/129466291-ee7f8726-bf17-47b6-b87c-5322b193048c.png" data-proofer-ignore></p><p>이 경우 각 표본당 평균 질문 갯수를 구하면 1.75다.</p><p>이 값은 p 분포의 엔트로피($H[p]$)를 구하면 얻을 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></table></code></div></div><p>한편 p분포 이외에도 q 분포가 있다고 하자.</p><p>q 분포는 다음과 같다.</p><p>$q = [0.25, 0.25, 0.25, 0.25]$</p><p>q분포는 확률질량값이 모두 똑같다. 따라서 아래 처럼 질문할 수 있다.</p><p><img width="631" alt="Screen Shot 2021-08-15 at 12 48 06" data-src="https://user-images.githubusercontent.com/83487073/129466406-1eeda6cd-6588-4030-b0d7-e98e33b8259e.png" data-proofer-ignore></p><p>이때 표본 1개 당 평균 질문 갯수는 2다.</p><p>그럼 이제 q분포에 따른 질문전략(모든 표본에 동일한 수의 질문 던지기)을 p분포 표본들을 추려내기 위해 사용해보자.</p><p>p 분포에서 나오는 표본은 A,B,C,D 였다.</p><p>이걸 q 질문 전략을 써서 추려내면 표본 1개 당 평균 질문 갯수는 2다.</p><p>이 값 2가 ‘교차엔트로피(크로스엔트로피)’ 값이다.</p><h2 id="p확률분포에서-나온-표본을-q분포에-따라-추려낼-때-p분포-표본-1개-당-평균-질문-갯수"><span class="mr-2">“p확률분포에서 나온 표본을 q분포에 따라 추려낼 때, p분포 표본 1개 당 평균 질문 갯수”</span><a href="#p확률분포에서-나온-표본을-q분포에-따라-추려낼-때-p분포-표본-1개-당-평균-질문-갯수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><p>p에서 나온 표본에 대해 최적의 질문전략(위 경우 p)를 썼을 때, 크로스엔트로피값은 최소화된다.</p><li><p>분포 q(새로운 질문전략)가 분포 p(최적 질문전략)와 비슷해질 수록 크로스엔트로피값은 줄어든다.</p></ul><hr /><h2 id="크로스엔트로피-식"><span class="mr-2">크로스엔트로피 식</span><a href="#크로스엔트로피-식" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>p, q가 이산확률분포</p><p>$H[p,q] = -\sum_{k=1}^{K} p(y_{k})\log_{2}{q(y_{k})}$</p><p>p, q가 연속확률분포</p><p>$H[p,q] = -\int_{y}p(y)\log_{2}{q(y)}dy$</p><p>또는 (이게 더 편해서 따로 기록)</p><p>$H[p,q] = KL(p\Vert q) + H[p]$</p><ul><li>범함수 입력으로 확률변수가 아닌 확률분포함수 p,q가 들어간다.<li>$H[p]$ 값은 분포 p 표본 1개당 평균 질문갯수로, 고정된 값이다.<li>KL 값은 q, p 분포 모양이 다른 정도다.</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># 크로스엔트로피 
</span><span class="k">def</span> <span class="nf">calc_cross_entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">zipped</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">q</span><span class="p">))</span>
    <span class="n">cross_entropy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">q</span> <span class="ow">in</span> <span class="n">zipped</span> <span class="p">:</span> 
        <span class="n">cross_entropy</span> <span class="o">+=</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">log2</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cross_entropy</span>
</pre></table></code></div></div><h2 id="세번째-크로스엔트로피-식에서-알-수-있는-사실"><span class="mr-2">세번째 크로스엔트로피 식에서 알 수 있는 사실</span><a href="#세번째-크로스엔트로피-식에서-알-수-있는-사실" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>크로스엔트로피는 p분포와 q분포가 같으면 최소화된다. 두 분포가 같을 때 KL 값이 0 되기 때문이다. 이때 크로스엔트로피 최솟값은 $H[p]$ 가 된다.<li>크로스엔트로피를 최소화 한다는 건 KL 값을 최소화 한다는 것과 같다.<li>크로스엔트로피는 p, q 분포 모양이 다를 수록 커진다.<li>크로스엔트로피는 사실상 p분포와 q분포 모양 다른 정도다.<li>크로스엔트로피 $\ge$ p분포 엔트로피</ol><hr /><h1 id="크로스엔트로피---분류모형-성능평가에-사용">크로스엔트로피 - 분류모형 성능평가에 사용</h1><ul><li><p>p와 q의 모양이 다른 정도(쿨백-라이블러 발산 값과 같다)</p><li><p>정답분포 p와 예측분포 q</p></ul><p>설명 :</p><p>$KL(p\vert \vert q) = H[p,q] - H[p]$</p><p>여기서 분류모형 성능측정할 때는 $H[p]$ 는 0이 된다(정답분포는 원핫인코딩벡터 꼴이기 때문). 따라서</p><p>$H[p,q] = KL(p\vert \vert q)$ 이다.</p><hr /><p>= 데이터 1개에 대한 예측이 틀릴 가능성</p><p>= 분류모형의 성능 나쁜 정도</p><ul><li><p>분류모형 성능이 나쁠 수록 크로스엔트로피 증가</p><li><p>분류모형 성능이 좋을 수록 크로스엔트로피 감소</p></ul><hr /><h1 id="로그손실---교차엔트로피-평균">로그손실 - 교차엔트로피 평균</h1><p>이진분류 문제에서 크로스엔트로피값은 데이터 1개에 대해 예측이 틀릴 가능성(분류모형 성능 나쁜 정도) 을 의미한다.</p><p>데이터 N개에 대해 각각의 교차엔트로핏값 평균을 구하면</p><h2 id="교차엔트로핏값-평균--데이터-n개에-대한-이진분류모형의-성능-나쁜-정도"><span class="mr-2">교차엔트로핏값 평균 : 데이터 N개에 대한 이진분류모형의 성능 나쁜 정도</span><a href="#교차엔트로핏값-평균--데이터-n개에-대한-이진분류모형의-성능-나쁜-정도" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="-이진분류모형의-손실함수오차함수"><span class="mr-2">= 이진분류모형의 손실함수(오차함수)</span><a href="#-이진분류모형의-손실함수오차함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이 교차엔트로핏값 평균을 로그손실 이라 한다.</p><p>로그손실을 최소화 (손실함수 최소화) 시킨다 = 분류모형 성능을 극대화 시킨다.</p><p>따라서</p><h2 id="로그손실-최소화--이진분류모형-성능-최적화-목표"><span class="mr-2">로그손실 최소화 = 이진분류모형 성능 최적화 목표.</span><a href="#로그손실-최소화--이진분류모형-성능-최적화-목표" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><hr /><p>로그손실 이용해 분류모형 성능 최적화(최대화) 예)</p><h2 id="데이터사이언스스쿨-연습문제-1031"><span class="mr-2">데이터사이언스스쿨 연습문제 10.3.1</span><a href="#데이터사이언스스쿨-연습문제-1031" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>사이킷런 패키지 붓꽃 데이터 중에서, 꽃받침 길이 데이터와 꽃받침 폭 데이터 중 어떤 데이터를 사용할 때 분류모형 성능이 극대화 되겠는가?</p><p>각 데이터 최솟값과 최댓값 구간을 0.05 간격으로 나눠서 각 값을 기준값 삼아 붓꽃 종을 세토사와 베르시칼라로 분류하자.</p><h3 id="1-꽃받침-길이-데이터-중-특정-기준값으로-붓꽃-종을-분류해보자"><span class="mr-2">1. 꽃받침 길이 데이터 중 특정 기준값으로 붓꽃 종을 분류해보자.</span><a href="#1-꽃받침-길이-데이터-중-특정-기준값으로-붓꽃-종을-분류해보자" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>기준값 설정하기 전에, 일단 데이터를 한번 훑어보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">greater</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">5.5</span><span class="p">][</span><span class="s">'species'</span><span class="p">])</span>
<span class="n">less</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">5.5</span><span class="p">][</span><span class="s">'species'</span><span class="p">])</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">greater</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'5.5 보다 큰'</span><span class="p">])</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">less</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'5.5 보다 작은'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'-'</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="116" alt="Screen Shot 2021-08-15 at 18 15 25" data-src="https://user-images.githubusercontent.com/83487073/129473520-f9951710-d088-4ee3-80d5-2aff355c500d.png" data-proofer-ignore></p><p><img width="555" alt="Screen Shot 2021-08-15 at 17 40 26" data-src="https://user-images.githubusercontent.com/83487073/129472503-501f8422-56c0-46ed-a0be-3cf6e2e958af.png" data-proofer-ignore></p><p>데이터를 살펴보니 5.5cm 언저리를 기점으로 5.5보다 큰 데이터들은 대체로 정답값이 1로 분류되어 있었고, 5.5보다 작은 값들은 대체로 0번 종으로 분류되어 있었다.</p><p>내가 만들 붓꽃 종 분류 모형이 5.5 언저리 특정 기준값을 기준으로 이 값보다 크면 1로 분류하고, 이 값보다 작으면 0으로 분류해야 분류모형이 주어진 정답 값(0,1)을 가장 잘 맞추게 될 것이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="c1"># 로그손실 값 그래프 그리는 함수 
</span><span class="k">def</span> <span class="nf">plot_log_loss</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> <span class="p">:</span> 
    <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">log_loss</span>
    <span class="n">criteria</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]),</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">])</span><span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">log_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">criteria</span> <span class="p">:</span> 
        <span class="k">if</span> <span class="n">reverse</span> <span class="o">==</span> <span class="bp">True</span> <span class="p">:</span> 
            <span class="n">df</span><span class="p">[</span><span class="s">'y_hat'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">log_loss_value</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'species'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s">'y_hat'</span><span class="p">])</span>
            <span class="n">log_losses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_loss_value</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> 
            <span class="n">df</span><span class="p">[</span><span class="s">'y_hat'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">log_loss_value</span> <span class="o">=</span> <span class="n">log_loss</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'species'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s">'y_hat'</span><span class="p">])</span>
            <span class="n">log_losses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_loss_value</span><span class="p">)</span>
            
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">criteria</span><span class="p">,</span> <span class="n">log_losses</span><span class="p">)</span>
    <span class="n">min_log_loss</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">min</span><span class="p">(</span><span class="n">log_losses</span><span class="p">)</span> <span class="p">;</span> <span class="n">optimized_value</span> <span class="o">=</span> <span class="n">criteria</span><span class="p">[</span><span class="n">log_losses</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">min_log_loss</span><span class="p">)]</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">optimized_value</span><span class="p">,</span> <span class="n">min_log_loss</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'최저 로그손실 값 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">min_log_loss</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">, 최적해(기준값) : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">optimized_value</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'로그손실값'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="558" alt="Screen Shot 2021-08-15 at 17 47 22" data-src="https://user-images.githubusercontent.com/83487073/129472689-85da678f-4744-4d34-8925-8bab7fbd56c4.png" data-proofer-ignore></p><p>df[‘종 이름’] &gt; 꽃받침 길이 기준 값</p><p>으로 코드를 짜 주어야 특정 기준값보다 큰 값들을 True=1, 작은 값들을 False=0 으로 분류할 것이다.</p><p>분류모형의 손실함수인 로그손실값을 각 기준점에서 계산해서 그래프로 그렸더니 위와 같았다.</p><p>손실함숫값인 로그손실값이 최소가 될 때가 분류모형 성능이 극대화되는 지점이다.</p><p>꽃받침 길이 5.45 cm 를 기준값으로 삼았을 때 로그손실값이 3.8로 최저가 되었다. 곧, 기준값 5.45일 때 분류모형 성능이 가장 극대화된다.</p><h3 id="2-꽃받침-폭-데이터-중-특정값을-기준으로-붓꽃-종을-분류해-보자"><span class="mr-2">2. 꽃받침 폭 데이터 중 특정값을 기준으로 붓꽃 종을 분류해 보자.</span><a href="#2-꽃받침-폭-데이터-중-특정값을-기준으로-붓꽃-종을-분류해-보자" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이번에도 실현된 데이터들 특징을 먼저 함 살펴보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">[</span><span class="s">'sepal width (cm)'</span><span class="p">].</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">hlines</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal width (cm)'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">][</span><span class="s">'species'</span><span class="p">])</span> <span class="c1"># 대체로 0
</span><span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal width (cm)'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">][</span><span class="s">'species'</span><span class="p">])</span> <span class="c1"># 대체로 1
</span><span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="s">'대체로 0'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="s">'대체로 1'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="555" alt="Screen Shot 2021-08-15 at 17 53 50" data-src="https://user-images.githubusercontent.com/83487073/129472852-a029b2f9-305b-4493-9d15-7df6b34087b3.png" data-proofer-ignore></p><p>대체로 3 언저리 특정값을 기준점으로 삼았을 때, 기준값보다 큰 값은 대체로 0번 종이 많았고, 기준값보다 작은 값은 대체로 1번 종이 많았다.</p><p>이 경우에는 df[‘종 이름’] &lt; 기준값 으로</p><p>코드를 짜야 특정 기준값보다 낮은 값은 True=1 로, 특정 기준값보다 큰 값은 False=0 으로 분류되어 실제 정답값을 잘 맞출 것이다.</p><p>이를 위해 ‘로그손실 값 그래프로 그리는 함수’에서, reverse argument 기본값을 False로 주고, 만약 True 가 들어올 경우 원래 df[‘종 이름’] &gt; 기준값 에서 부등호 방향이 &lt; 가 되도록 했다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">plot_log_loss</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">'sepal width (cm)'</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="560" alt="Screen Shot 2021-08-15 at 18 00 07" data-src="https://user-images.githubusercontent.com/83487073/129473045-dae455b2-1c51-47c6-9710-516f1c32cad3.png" data-proofer-ignore></p><p>꽃받침 폭 특정값을 기준값으로 삼아 각 기준값에서의 로그손실값을 그래프로 그렸다.</p><p>기준값이 3.05 일 때 로그손실값이 5.53으로 최저가 되었다.</p><p>곧, 꽃받침 폭 3.05cm 를 기준점으로 삼아 데이터들을 종 별로 분류했을 때 분류모형 성능이 가장 극대화 된다는 의미다.</p><p>꽃받침 길이 최적값과 꽃받침 폭 최적값 중 로그손실값이 더 작은 값이 분류모형 성능을 더 극대화할 수 있는(종 별 분류를 더 잘 해낼 수 있는) 값이다.</p><p>꽃받침 길이 최적값에서 로그손실값이 더 작아졌다. 따라서 꽃받침 길이가 분류모형 성능 극대화에 두 값 중 더 적합한 특징값이다.</p><hr /><h1 id="쿨백-라이블러발산-상대엔트로피">쿨백-라이블러발산 (상대엔트로피)</h1><p>$KL(p\Vert q) = H[p,q] - H[p]$</p><ul><li>정의 : (임의의 두 분포) q분포가 p분포와 모양 다른 정도</ul><p>p분포는 비교기준이 된다.</p><p>설명)</p><p>p분포에서 나온 표본을 q 분포에 따라 추려냈을 때 p분포 표본 1개 당 평균 정보량 - 최적 질문전략 썼을 때 p분포 표본 1개 당 평균 정보량 = KL 발산 값</p><p>곧, KL 발산값은 정보량(질문갯수) 차이다.</p><p>이 질문갯수 차이는 p분포와 q분포 모양이 비슷할 수록 줄어들고, p분포와 q분포 모양이 다를 수록 커진다.</p><p>$\Rightarrow$ KL 발산값 = q분포와 p분포 모양 다른 정도</p><h2 id="사이파이-쿨백-라이블러-발산값-계산-코드"><span class="mr-2">사이파이 쿨백-라이블러 발산값 계산 코드</span><a href="#사이파이-쿨백-라이블러-발산값-계산-코드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>기존 사이파이 엔트로피 값 계산 코드에 p와 q 분포를 함께 집어넣으면 된다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></table></code></div></div><p>p : 모양 비교기준이 되는 확률분포</p><p>q : 기준분포 p와 모양 비교 할 확률분포</p><hr /><h1 id="쿨백-라이블러발산-성질">쿨백-라이블러발산 성질</h1><ul><li>KL 발산 최솟값은 0이다.</ul><p>p분포와 q분포 모양이 완전히 같을 때 KL 발산값 0 된다.</p><ul><li>$KL \ge 0$</ul><p>$KL = H[p,q] - H[p]$ 였다. 크로스엔트로피는 언제나 $H[p]$ 보다 같거나 컸다. 따라서 $KL$ 값도 항상 0 또는 양수다.</p><ul><li>$KL(p\Vert q) \ne KL(q\Vert p)$</ul><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/python/'>python</a>, <a href='/categories/mathematics/'>mathematics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/datascience/" class="post-tag no-text-decoration" >datascience</a> <a href="/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%EC%88%98%ED%95%99%2F%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%5D+%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EA%B2%B0%ED%95%A9%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%A1%B0%EA%B1%B4%EB%B6%80%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%ED%81%AC%EB%A1%9C%EC%8A%A4%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%BF%A8%EB%B0%B1-%EB%9D%BC%EC%9D%B4%EB%B8%94%EB%9F%AC+%EB%B0%9C%EC%82%B0+-+der+Wille+zur+Macht&url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fdistribution_and_entropy%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%EC%88%98%ED%95%99%2F%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%5D+%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EA%B2%B0%ED%95%A9%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%A1%B0%EA%B1%B4%EB%B6%80%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%ED%81%AC%EB%A1%9C%EC%8A%A4%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%BF%A8%EB%B0%B1-%EB%9D%BC%EC%9D%B4%EB%B8%94%EB%9F%AC+%EB%B0%9C%EC%82%B0+-+der+Wille+zur+Macht&u=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fdistribution_and_entropy%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fdistribution_and_entropy%2F&text=%5B%EC%88%98%ED%95%99%2F%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%5D+%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EA%B2%B0%ED%95%A9%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%A1%B0%EA%B1%B4%EB%B6%80%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%ED%81%AC%EB%A1%9C%EC%8A%A4%EC%97%94%ED%8A%B8%EB%A1%9C%ED%94%BC%2C+%EC%BF%A8%EB%B0%B1-%EB%9D%BC%EC%9D%B4%EB%B8%94%EB%9F%AC+%EB%B0%9C%EC%82%B0+-+der+Wille+zur+Macht" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="tigerkey10/bioinfo.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/classifier/">[알고리즘/지도학습] 로지스틱 회귀, 서포트벡터 머신, 나이브 베이즈 알고리듬, 분류모형 별 성능 비교</a><li><a href="/posts/regressor/">[알고리즘/지도학습] 회귀문제 - 선형회귀, 의사결정회귀나무, 의사결정회귀나무 앙상블(그래디언트 부스트)</a><li><a href="/posts/boosting/">[알고리즘/지도학습] 앙상블 알고리즘-부스팅(에이다 부스트, 그래디언트 부스트)</a><li><a href="/posts/ensemble/">[알고리즘/지도학습] 앙상블 알고리즘-취합(다수결 투표, 배깅, 랜덤포레스트)</a><li><a href="/posts/decision_tree/">[알고리즘/지도학습] 의사결정나무(Decision Tree) 알고리듬</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/baysian/"><div class="card-body"> <em class="small" data-ts="1624460400" data-df="YYYY-MM-DD" > 2021-06-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률론] 베이즈 정리</h3><div class="text-muted small"><p> 2021-06-24 베이즈정리 복습 베이즈 정리 중간에 들어온 정보로 인해(사건 B가 발생) 사건 A 사전확률이 어떻게 사후확률로 변하는지 보여준다. $P(A\vert{B}) = \frac{P(B\vert{A})P(A)}{P(B)}$ $P(A)$ : 사전확률 $P(B\vert{A})$ : 가능도 $P(B)$ : 정규화상수...</p></div></div></a></div><div class="card"> <a href="/posts/random_variable_vector_and_others/"><div class="card-body"> <em class="small" data-ts="1624806000" data-df="YYYY-MM-DD" > 2021-06-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 확률변수벡터, 결합.조건부.주변확률분포, 확률변수 독립</h3><div class="text-muted small"><p> 다변수 확률변수 벡터를 표본으로 내놓는 확률변수 결합확률분포함수는 기본적으로 다변수함수다 (입력변수 여러개-벡터 / 출력변수 1개-스칼라) 따라서 결합확률분포함수는 3d 서피스플롯 등 3차원 그래프로 나타낼 수 있다. 예컨대 P_XY(x,y) 라는 결합확률질량함수가 있다. 이 함수는 2차원 벡터 $[x, y]$ 의 확률질량값을 할당하는 함...</p></div></div></a></div><div class="card"> <a href="/posts/covariance/"><div class="card-body"> <em class="small" data-ts="1624978800" data-df="YYYY-MM-DD" > 2021-06-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/메모] 다변수확률변수 공분산_메모</h3><div class="text-muted small"><p> 표본 공분산 일반적인 확률변수는 시뮬레이션(=시행) 한 번 할 때 마다 스칼라 표본 하나씩을 내놓는다. 이 표본은 확률적 데이터로, 확률변수의 확률분포에 따라 현실세계로 튕겨져 나온 ‘데이터’다. 만약 스칼라 표본을 내놓는 이러한 확률변수가 $X,Y$ 둘이 있다고 가정해보자. 표본 공분산은 $x$ 표본과 $y$ 표본이 동시에 $x$ 평균과 $y...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/scipy_package_estimation/" class="btn btn-outline-primary" prompt="이전 글"><p>[수학/확률과 통계] Scipy 패키지를 이용한 검정 방법</p></a> <a href="/posts/mutual_information/" class="btn btn-outline-primary" prompt="다음 글"><p>[수학/엔트로피] 상호정보량(MI), 최대정보 상관계수(MIC)</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
