<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="[수학/확률과 통계] 베이즈추정, 검정(testing)" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="공부 중인 내용을 정리한 글" /><meta property="og:description" content="공부 중인 내용을 정리한 글" /><link rel="canonical" href="https://kibeomkim.me/posts/basian_estimation/" /><meta property="og:url" content="https://kibeomkim.me/posts/basian_estimation/" /><meta property="og:site_name" content="der Wille zur Macht" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-07T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[수학/확률과 통계] 베이즈추정, 검정(testing)" /><meta name="google-site-verification" content="1CLBUlwAX10LXrW4RzkPuaeWtey34c3dyngs14cKrCw" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-08-08T00:00:00+09:00","datePublished":"2021-08-07T00:00:00+09:00","description":"공부 중인 내용을 정리한 글","headline":"[수학/확률과 통계] 베이즈추정, 검정(testing)","mainEntityOfPage":{"@type":"WebPage","@id":"https://kibeomkim.me/posts/basian_estimation/"},"url":"https://kibeomkim.me/posts/basian_estimation/"}</script><title>[수학/확률과 통계] 베이즈추정, 검정(testing) | der Wille zur Macht</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="der Wille zur Macht"><meta name="application-name" content="der Wille zur Macht"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "AMS" } }, tex2jax: { inlineMath: [ ['$', '$'] ], displayMath: [ ['$$', '$$'] ], processEscapes: true, } }); MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) { alert("Math Processing Error: "+message[1]); }); MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) { alert("Math Processing Error: "+message[1]); }); </script> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/emoge.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">der Wille zur Macht</a></div><div class="site-subtitle font-italic">10,000 Hours</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>타임라인</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a> <a href="https://github.com/tigerkey10" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kkb1004tom','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[수학/확률과 통계] 베이즈추정, 검정(testing)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[수학/확률과 통계] 베이즈추정, 검정(testing)</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1628262000" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-08-07 </em> </span> <span> 업데이트 <em class="" data-ts="1628380800" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2021-08-08 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6440 단어"> <em>35 분</em>읽는 시간</span></div></div></div><div class="post-content"><h1 id="베이즈추정법--모수-mu-의-신뢰도-분포를-나타내는-작업">베이즈추정법 : 모수 $\mu$ 의 신뢰도 분포를 나타내는 작업</h1><ul><li>핵심 아이디어 : 모수 = 확률변수<li>주어진 데이터를 기반으로 모수 $\mu$ 의 조건부확률분포 $p(\mu \vert x_{1}, x_{2}…x_{n})$ 을 계산하는 작업이다.<li><p>베이즈정리를 사용한다.</p><li>최대가능도추정법과의 연결점 : 가장 가능성 높은 모수를 ‘추정 모수’(추정 결과) 로 쓰겠다.<li>최대가능도추정법과의 차별점 :<h2 id="1-최대가능도추정법에서는-가장-가능도-높은-모수-mu-하나를-찾는-게-모든-관심사였다"><span class="mr-2">1. 최대가능도추정법에서는 가장 가능도 높은 모수 $\mu$ 하나를 찾는 게 모든 관심사였다.</span><a href="#1-최대가능도추정법에서는-가장-가능도-높은-모수-mu-하나를-찾는-게-모든-관심사였다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></ul><p>하지만 베이지안 추정법은 가장 가능성 높은 모수를 찾고, 찾은 모수가 얼마만큼의 추정 신뢰도와 신뢰구간에서 찾아진건지도 알 수 있다는 장점 있다.</p><p>즉 가장 가능성 높은 모수를 찾고, 이걸 ‘얼마만큼 믿을 수 있는가’에 대해서도 제시한다. MLE 방법과 비교했을 때 모수추정을 더 세밀하게 할 수 있는 것이다.</p><h2 id="2-새-데이터를-추가로-얻었을-때-계산해둔-기존-결과에-추가된-것만-그대로-반영해서-업데이트된-결과물-얻을-수-있다"><span class="mr-2">2. 새 데이터를 추가로 얻었을 때, 계산해둔 기존 결과에 추가된 것만 그대로 반영해서 업데이트된 결과물 얻을 수 있다.</span><a href="#2-새-데이터를-추가로-얻었을-때-계산해둔-기존-결과에-추가된-것만-그대로-반영해서-업데이트된-결과물-얻을-수-있다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>최대가능도추정법의 경우 데이터 새로 얻으면 모든 데이터를 가지고 처음부터 다시 계산해야 한다.(번거롭다)</p><h1 id="모수-mu-의-신뢰도-분포-나타내는-방법">모수 $\mu$ 의 신뢰도 분포 나타내는 방법</h1><ol><li>모수적 방법 - 모수 $\mu$ 의 조건부확률분포를 다른 확률분포 빌려서 [직접] 표현하는 방법<li>비모수적 방법 - 모수 $\mu$ 의 조건부확률분포에서 직접 표본 추출해서, 히스토그램 그려서 [간접] 표현하는 방법</ol><h1 id="모수적-방법---다른-확률분포-빌려서-모수분포-직접-표현하기">모수적 방법 - 다른 확률분포 빌려서 모수분포 직접 표현하기</h1><ul><li>모수분포는 베이즈 정리의 출력 모수 $\mu$ 의 조건부분포를 말한다.</ul><p>$p(\mu \vert x_{1}, x_{2}…x_{n}) = p(x_{1}, x_{2}…\vert \mu)p(\mu)$</p><ul><li><p>모수 $\mu$ 에 대한 별 다른 정보 없을 경우 사전분포 $p(\mu)$ 는 모수 a=1, b=1 인 베타분포 또는 기댓값이 0인 정규분포 등의 무정보분포(엔트로피가 가장 큰) 를 사용한다.</p><li><p>사전분포와 사후분포 분포 종류가 같으면, ‘켤레분포’ 또는 ‘켤레사전확률분포’라고 한다.</p><li><p>모수의 분포(사후분포)를 나타내는 다른 확률분포의 모수를 ‘하이퍼 모수’라고 한다. 모수적 방법은 이 ‘하이퍼 모수’를 계산하는 작업이다.</p><li><p>예를 들어 베르누이 확률변수 모수 $\mu$ 의 사후분포를 모수적 방법으로 나타낼 때, 사후분포의 하이퍼 모수는 다음처럼 계산할 수 있다.</p></ul><p>$a’ = N_{1}+a$</p><p>$b’ = N_{0}+b$</p><p>갱신된 하이퍼 모수를 갖는 베타분포(사후분포)는 곧 모수 $\mu$ 의 신뢰도분포다.</p><p>예1 )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">a0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># 사전분포의 하이퍼모수
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a0</span><span class="p">,</span><span class="n">b0</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'사전분포'</span><span class="p">)</span>

<span class="n">a1</span> <span class="o">=</span> <span class="mi">60</span><span class="o">+</span><span class="mi">1</span>
<span class="n">b1</span> <span class="o">=</span> <span class="mi">40</span><span class="o">+</span><span class="mi">1</span> <span class="c1"># 사후분포의 하이퍼모수
</span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'g'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'사후분포'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'상품 B 모수 조건부 분포의 사전분포와 사후분포'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="737" alt="Screen Shot 2021-08-07 at 14 59 05" data-src="https://user-images.githubusercontent.com/83487073/128589891-ca28257b-68e6-4ae5-8c3e-6e86d79163ee.png" data-proofer-ignore></p><p>예2 )</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1"># 실제 베르누이분포 모숫값 : 0.65
# 베이즈 추정법 사용한 모수추정을 해보자. 
# 데이터 50개씩 추가해가면서 추정 결과를 업데이트하자. 
</span>
<span class="n">mu0</span> <span class="o">=</span> <span class="mf">0.65</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span>  <span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">'사전분포'</span><span class="p">)</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s">':'</span><span class="p">,</span> <span class="s">'--'</span><span class="p">,</span> <span class="s">'-.'</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s">'r'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">sample</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">mu0</span><span class="p">).</span><span class="n">rvs</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">n0</span><span class="p">,</span> <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">sample</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="p">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">sample</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">n0</span> <span class="o">+</span> <span class="n">b</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">번째 추정'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">차 추정 : 모드 = </span><span class="si">{</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'데이터 50개씩 추가해가며 베이지안 추정결과 업데이트하기'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'$\mu$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.65</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

</pre></table></code></div></div><p><img width="736" alt="Screen Shot 2021-08-07 at 15 34 17" data-src="https://user-images.githubusercontent.com/83487073/128590915-c5418c0c-a1d7-475e-9749-05feeb3af1b0.png" data-proofer-ignore></p><p>예3 )</p><p>베이즈추정법으로 정규분포 기댓값 모수 $\mu$ 추정하기</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c1"># 100개 씩 총 4번 데이터 얻어서 기댓값 모수를 추정해보자. 
</span><span class="n">target_mu</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">target_sigma2</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'b'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'사전분포'</span><span class="p">)</span>

<span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="s">':'</span><span class="p">,</span> <span class="s">'--'</span><span class="p">,</span> <span class="s">'-.'</span><span class="p">,</span> <span class="s">'-'</span><span class="p">]</span>
<span class="n">color</span><span class="o">=</span> <span class="p">[</span><span class="s">'k'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">]</span>
<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span> 
    <span class="n">sample</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">target_mu</span><span class="p">,</span> <span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">target_sigma2</span><span class="p">)).</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">target_sigma2</span><span class="o">/</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">sigma2</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="n">sigma2</span><span class="o">/</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">sigma2</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sigma2</span><span class="o">+</span><span class="mi">100</span><span class="o">/</span><span class="n">target_sigma2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma2</span><span class="p">)).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">번째 추정'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">번째 추정 모드 : mode = </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'베이지안 추정법을 통한 정규분포 모수 $\mu$ 추정'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">target_mu</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="735" alt="Screen Shot 2021-08-07 at 17 05 35" data-src="https://user-images.githubusercontent.com/83487073/128593440-fe39ddac-761b-44e6-8a68-cbf9367eef49.png" data-proofer-ignore></p><p>예4 )</p><p>사이킷런 패키지 붓꽃 데이터 중 ‘꽃받침 길이’ 확률변수의 기댓값 모수 추정</p><ol><li>꽃받침 길이 데이터들이 어떤 분포를 이루는지 보고, 이 데이터들이 어떤 분포에서 나왔는지 대강 짐작해보자.</ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">().</span><span class="n">data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">load_iris</span><span class="p">().</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s">'sepal length (cm)'</span><span class="p">]]</span>
</pre></table></code></div></div><p><img width="163" alt="Screen Shot 2021-08-07 at 17 29 13" data-src="https://user-images.githubusercontent.com/83487073/128594130-d3555106-1fa0-47d7-b5d1-aefcc640feb0.png" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">values</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="732" alt="Screen Shot 2021-08-07 at 17 30 11" data-src="https://user-images.githubusercontent.com/83487073/128594153-61fb8de4-3ca7-49b2-9eba-fa865387b877.png" data-proofer-ignore></p><p>모양을 보니 정규분포에서 나온 데이터 일 수 있겠다.</p><p>정규분포에서 나온 데이터라고 가정하고, 베이즈추정으로 기댓값 모수를 추정해보자.</p><p>분산모수는 표본분산을 사용해서 안다고 가정한다.</p><ol><li>모수 $\mu$ 가 정규분포 기댓값 모수이므로 $-\infty +\infty$ 사이 값일 것이다. 이외에 다른 정보는 주어진 게 없다. 따라서 기댓값 0인 무정보분포를 모수 $\mu$ 의 사전분포로 쓰자. 무정보분포의 분산 $\sigma^{2}$ 은 1이라 가정한다.</ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'정규분포 기댓값 모수 $\mu$ 의 사전확률분포'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="729" alt="Screen Shot 2021-08-07 at 17 36 06" data-src="https://user-images.githubusercontent.com/83487073/128594394-d01e8b22-1dc7-4e44-a933-5002fbbc2e52.png" data-proofer-ignore></p><ol><li>내가 가진 데이터를 반영한 사후분포의 하이퍼모수를 구한다. 그리고 기댓값 모수 $\mu$ 의 사후분포를 나타내자.</ol><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'사전분포'</span><span class="p">)</span>

<span class="n">target_sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">values</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">values</span>

<span class="n">mu1</span> <span class="o">=</span> <span class="n">target_sigma2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">sigma2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">sigma2</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sigma21</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sigma2</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="n">target_sigma2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma21</span><span class="p">)).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">'사후분포'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'베이지안 추정으로 정규분포의 기댓값 모수 추정 결과'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'추정된 정규분포 기댓값 모수 : </span><span class="si">{</span><span class="n">mu1</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="736" alt="Screen Shot 2021-08-07 at 17 47 33" data-src="https://user-images.githubusercontent.com/83487073/128594684-2b97f2d3-28d9-4ce9-a8a4-0697f4535a12.png" data-proofer-ignore></p><p>최종적으로 추정된 정규분포 기댓값 모수 : 5.81674331232002</p><h1 id="모멘트방법으로-구한-기댓값-모수와의-비교">모멘트방법으로 구한 기댓값 모수와의 비교</h1><p>모멘트 방법에 따르면 표본평균은 이론적 기댓값과 같았다.</p><p>주어진 데이터를 이용해서 표본평균을 구하면 약 5.84가 나온다.</p><p>모멘트방법에 따라 이 5.84가 이론적 기댓값과 같다고 보면 5.84는 곧 정규분포의 기댓값 모수다.</p><p>내가 베이즈추정법으로 추정한 정규분포 기댓값 모수와 모멘트방법의 결과 5.84를 비교해보면, 약간의 차이가 있긴 하지만 두 방법 모두 비슷한 값을 모수로 추정해 낸 것을 볼 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">fit</span><span class="o">=</span><span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'표본분포 : 표본평균 이용해 구한 이론적 기댓값 = 5.84'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">5.84</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>


<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">target_sigma2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">values</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'sepal length (cm)'</span><span class="p">].</span><span class="n">values</span>

<span class="n">mu1</span> <span class="o">=</span> <span class="n">target_sigma2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">mu</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">sigma2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="n">sigma2</span><span class="o">+</span><span class="n">target_sigma2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">sigma21</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sigma2</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="n">target_sigma2</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">5.84</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">5.82</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'b'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">mu1</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma21</span><span class="p">)).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s">'사후분포 : 베이즈추정법으로 구한 추정 기댓값 : 5.82'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="737" alt="Screen Shot 2021-08-07 at 18 08 18" data-src="https://user-images.githubusercontent.com/83487073/128595177-ff1446ea-18a4-44e5-ac00-c8a1ed6296bc.png" data-proofer-ignore></p><hr /><h1 id="검정-testing--확률분포에-대한-가설이-맞는지-틀리는지-증명하는-작업">검정 (testing) : 확률분포에 대한 가설이 맞는지 틀리는지 증명하는 작업</h1><ul><li>검정의 기본 전제 : 추정된 ‘추정값’은 ‘추정값’일 뿐이다!</ul><p>추정 결과가 참인지, 거짓인지 판단할 여지가 남아있다!</p><hr /><p>예)</p><p>문) 동전을 15번 던졌는데 12번 앞면이 나왔다. 이 동전은 공정한 동전이라 할 수 있을까?</p><p>답) ‘동전 던지기 결과’는 베르누이확률변수라고 볼 수 있다.</p><p>베르누이확률변수의 모수는 $\mu$ 이다.</p><p>모수가 얼마일지, 추정해보자.</p><p>먼저 최대가능도추정법(MLE) 방법으로 베르누이확률변수의 모수를 추정해보자.</p><p>$\frac{N_{1}}{N}$</p><p>이다. 따라서 $\frac{12}{15}$ 가 베르누이확률변수의 모수 $\mu$ 라고 추정할 수 있다.</p><p>한편 베이즈추정법으로 모수를 추정해보자.</p><p>모수 $\mu$ 의 사후분포를 나타낼 하이퍼모수는 다음과 같이 계산할 수 있다.</p><p>$a’= N_{1} + a$ $b’= N_{0} + b$</p><p>하이퍼모수로 사후분포를 묘사, 모수를 추정하면 0.8로 나온다. 최대가능도 추정법 결과와 같았다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="c1"># 동전 15번 던져 12번 앞면 나왔다. 공정한 동전이라 할 수 있나? 
# 베이즈 추정법으로 찾은 베르누이 확률변수 모수 
</span><span class="n">a0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b0</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">a1</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">b1</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a0</span><span class="p">,</span><span class="n">b0</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">mode</span> <span class="o">=</span> <span class="mi">12</span><span class="o">/</span><span class="mi">15</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'mode : </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">':'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.77</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s">'mode'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="727" alt="Screen Shot 2021-08-07 at 22 00 06" data-src="https://user-images.githubusercontent.com/83487073/128600995-130767a7-918f-407c-a44e-a5f901176776.png" data-proofer-ignore></p><p>그렇다면 모수추정 결과값은 0.8이라 할 수 있다. 이 0.8이 정말 모숫값이라면 이 동전은 ‘조작된 동전’일 것이다.</p><p>한편 0.8이 우연히 나온 결과에 불과하고, 실제 모수가 0.5라면 동전은 ‘공정한 동전’이라 말 할 수 있다.</p><p>이렇게 추정결과가 참인지 거짓인지 확인해 나가는 과정을 ‘검정’ 이라 한다.</p><hr /><ul><li>가설(H) : 확률분포에 대한 주장<li>검정(testing) : 확률분포에 대한 가설이 맞는지, 틀리는지 증명하는 작업<li>모수검정 : 모수에 대한 가설이 맞는지 틀리는지 증명하는 과정</ul><h2 id="귀무가설--기준상태-도전의-대상"><span class="mr-2">귀무가설 : 기준상태, 도전의 대상</span><a href="#귀무가설--기준상태-도전의-대상" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>정의 : 모수에 대한 가설<li>표기 : $H_{0}$</ul><p>영 가설 이라고도 한다.</p><ul><li>형태 : 반드시 ‘등식’ 꼴이어야 한다</ul><p>‘모수 = 증명하려는 가설의 기준값 상수’</p><p>형태다.</p><h2 id="대립가설--연구가설-증명대상-내가-증명하고-싶은-것"><span class="mr-2">대립가설 : 연구가설, 증명대상, 내가 증명하고 싶은 것</span><a href="#대립가설--연구가설-증명대상-내가-증명하고-싶은-것" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>정의 : 내가 주장하려는 가설<li>표기 : $H_{a}$<li><p>언제나 귀무가설과 한 쌍(pair)를 이룬다.</p><li>귀무가설과 대립가설은 꼭 여집합 관계일 필요는 없다.</ul><p>여집합 관계이면 귀무가설 거짓일 때, 자동으로 대립가설은 참이 된다.</p><p>한편 만약 여집합 관계가 아니라면 귀무가설이 거짓이라고 해서 자동으로 대립가설이 참 임이 증명되지 않는다.</p><p>따라서 여집합 관계가 아닐 때 대립가설이 참 임을 증명하려면 1. 귀무가설이 거짓임 2. 대립가설이 참임 1,2, 두 가지를 모두 증명해야 한다.</p><hr /><h1 id="검정통계량">검정통계량</h1><ul><li>정의 : 귀무가설이 맞거나 틀렸다는 것을 증명할 ‘증거’<li>t로 나타낸다.<li>확률변수 X에서 나온 표본데이터를 입력으로 받아 출력된 함숫값이다.<li>검정통계량 값도 표본데이터에의해 확률적 데이터가 나오는 확률변숫값이다. 따라서 검정통계량확률변수(분포) T 에서 나온 값이라고 본다.</ul><p>*통계량 : 표본데이터를 하나의 공식에 넣어서 얻어낸 하나의 값</p><hr /><p>$\Leftarrow$ 확률변수 X 의 데이터로부터 어차피 X의 모수 추정하고 모수에 대한 가설(이 모수가 참인가? 거짓인가?)까지 세웠을 것이다.</p><p>$\Leftarrow$ 이 가설 증명하려면 이 데이터들을 검정통계량 값으로 바꾸면 된다.</p><p>$\Leftarrow$ 이 검정통계량 값은 확률변수 값으로써, 특정한 검정통계량분포에서 나온 값이다.</p><p>$\Leftarrow$ 내가 들고 있는 검정통계량 값이 검정통계량 분포 내에서 어디쯤 위치하는지 보고, 귀무가설 참. 거짓 유무 판단하면 된다.</p><hr /><h1 id="자주-사용하는-검정통계량--검정통계량분포">자주 사용하는 검정통계량 &amp; 검정통계량분포</h1><h2 id="베르누이분포-확률변수"><span class="mr-2">베르누이분포 확률변수</span><a href="#베르누이분포-확률변수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>베르누이확률변수의 모수에 대한 가설을 증명하려면 :<li>검정통계량 값 : N번 중 성공한 횟수 n 번<li>검정통계량이 따르는 분포 : 이항분포</ul><h2 id="sigma2-모수를-아는-정규분포-확률변수"><span class="mr-2">$\sigma^{2}$ 모수를 아는 정규분포 확률변수</span><a href="#sigma2-모수를-아는-정규분포-확률변수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>정규분포확률변수의 모수에 대한 가설을 증명하려면 :<li>검정통계량 값 : 표본평균을 정규화한 Z 통계량 값<li>검정통계량이 따르는 분포 : 표준정규분포</ul><h2 id="sigma2-모수를-모르는-정규분포-확률변수"><span class="mr-2">$\sigma^{2}$ 모수를 모르는 정규분포 확률변수</span><a href="#sigma2-모수를-모르는-정규분포-확률변수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>정규분포확률변수의 기댓값 모수 $\mu$ 에 대한 가설을 증명하려면 :<li>검정통계량 값 : 표본평균을 표본표준편차 s 로 정규화한 t 통계량 값<li>검정통계량이 따르는 분포 : 자유도 N-1 인 스튜던트 t 분포</ul><hr /><ul><li>$\sigma^{2}$ 에 대한 가설을 증명하려면 :<li>검정통계량 값 : 표본분산 $s^{2}$ 을 정규화한 값</ul><p>$t = (N-1) \frac{s^{2}}{\sigma^{2}}$</p><ul><li>검정통계량이 따르는 분포 : 자유도 N-1인 카이제곱분포</ul><hr /><h1 id="유의확률-p-value">유의확률 (p-value)</h1><ul><li><p>귀무가설이 진실이라면, 내가 손에 쥐고 있는 검정통계량 값은 검정통게량분포에서 흔하게, 잘 나오는 값일 것이다.</p><li><p>귀무가설이 거짓이라면, 검정통계량값은 검정통계량분포에서 나오기 어려운 값일 것이다.</p></ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>

<span class="n">black</span> <span class="o">=</span> <span class="p">{</span><span class="s">'facecolor'</span> <span class="p">:</span> <span class="s">'black'</span><span class="p">}</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'나오기 쉬운 값이 나온 경우(귀무가설이 참)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">().</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">'실현된 검정통계량값 $t_{0}$'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.05</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">black</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'나오기 어려운 값이 나온 경우(귀무가설이 거짓)'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">norm</span><span class="p">().</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">'실현된 검정통계량값 $t_{0}$'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.05</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">black</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'실현된 검정통계량값과 검정통계량분포'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="735" alt="Screen Shot 2021-08-08 at 14 12 15" data-src="https://user-images.githubusercontent.com/83487073/128621577-6a5dfac2-d31b-4bee-bcf0-036fab04ba1e.png" data-proofer-ignore></p><h2 id="유의확률-p-value-1"><span class="mr-2">유의확률 (p-value)</span><a href="#유의확률-p-value-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>정의 : 검정통계량분포의 표본값 1개가 주어졌을 때, 내가 들고 있는 표본값 또는 그 값보다 더 희귀한 값들이 나올 수 있는 확률</ul><p>또는</p><p>귀무가설이 맞다고 할 때, 현재 검정통계량값 &amp; 더 희귀한 값들(대립가설 옹호하는) 이 나올 확률</p><p>$p(t for H_{a}\vert H_{0})$</p><hr /><h2 id="논리흐름"><span class="mr-2">논리흐름)</span><a href="#논리흐름" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>유의확률이 작다 : 귀무가설이 참 이면 주어진 표본 &amp; 이것보다 희귀한 놈들이 나올 가능성 매우 낮다</p><p>$\Rightarrow$ 주어진 표본이 나왔다는 건 귀무가설 참인데 매우 낮은 가능성으로 이 표본이 나왔거나, 또는 귀무가설이 거짓이란 말이다.</p><h2 id="한편"><span class="mr-2">한편</span><a href="#한편" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>유의확률이 크다 : 귀무가설이 참 일 때 주어진 표본 &amp; 이것보다 희귀한 놈들이 나올 가능성 높다</p><p>$\Rightarrow$ 귀무가설이 참이면 내가 들고 있는 표본 같은 놈들이 자주 나온다.</p><p>$\Rightarrow$ 주어진 표본은 귀무가설을 기각할만한 증거가 못 된다.</p><hr /><ul><li><p>유의확률은 누적분포함수 cdf 이용해서 구할 수 있다.</p><li><p>유의확률이 검정통계량분포의 양쪽 끝단 면적 구한 것과 같으면 ‘양측검정 유의확률’ 이라고 한다.</p></ul><h1 id="단측검정-유의확률">단측검정 유의확률</h1><ul><li>정의 : 한쪽방향 유의확률만 사용하는 것.<li>사용 : 대립가설이 부등식 형태일 때<li>모수가 특정값 $\theta_{0}$ 보다 크다는 걸 증명하고 싶으면 ‘우측검정 유의확률’을 써야 한다.<li>모수가 특정값 $\theta_{0}$ 보다 작다는 걸 증명하고 싶으면 ‘좌측검정 유의확률’을 써야 한다.</ul><h1 id="유의수준">유의수준</h1><ul><li>정의 : ‘기준점’. 귀무가설을 기각할 지 채택할 지 판단하는 기준점이다.<li>종류 : 1%, 5%, 10% 유의수준</ul><p>유의확률이 유의수준보다 작으면 - 귀무가설 기각, 대립가설 채택</p><p>유의확률이 유의수준보다 크면 - 귀무가설 채택</p><h1 id="기각역--검정통계량분포에서-유의수준에-해당하는-검정통계량값지점">기각역 : 검정통계량분포에서 유의수준에 해당하는 검정통계량값(지점)</h1><ul><li>활용 :</ul><ol><li><p>유의수준만큼에 해당하는 기각역 계산</p><li><p>내가 얻은 검정통계량 값과 기각역 바로 비교 (지점-지점 비교)</p><li><p>귀무가설 기각 / 채택 여부 판단 가능</p></ol><hr /><h1 id="위에서-들었던-예를-통해-직접-검정해보자---1">위에서 들었던 예를 통해 직접 검정해보자 - 1</h1><ul><li>동전던지기 결과는 베르누이확률변수다.<li>추정된 모수 값은 $\mu = 0.8$ 이었다.</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">plt</span><span class="p">.</span><span class="n">bar</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="mf">0.8</span><span class="p">).</span><span class="n">pmf</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'최대가능도추정법, 베이즈추정법으로 추정한 모수 : $\mu = 0.8$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">'불공정한 동전인가?'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="734" alt="Screen Shot 2021-08-08 at 16 41 21" data-src="https://user-images.githubusercontent.com/83487073/128624767-ddc51cd9-9e9b-4015-9128-1dda47e2b07e.png" data-proofer-ignore></p><p>추정된 모수 $\mu = 0.8$ 만 보면 이 동전은 불공정한 동전같다.</p><p>이 동전이 불공정한 동전이다! 라는 주장을 그러면 검정해보자.</p><p>대립가설은 이렇게 세울 수 있다.</p><p>$H_{a} : \mu \ne 0.5$</p><p>그러면 귀무가설은 다음과 같다.</p><p>$H_{0} : \mu = 0.5$</p><p>이제 그러면 귀무가설(도전의 대상)이 참인지 거짓인지 증명해보자.</p><p>동전던지기 확률변수 X 는 베르누이확률변수였다. 베르누이확률변수 모수 $\mu$ 에 대한 가설을 증명하고 싶을 때, 검정통계량 값으로 이항분포의 표본값을 쓸 수 있고 검정통계량분포는 이항분포를 쓸 수 있었다.</p><p>검정통계량분포 기본 전제는 ‘귀무가설이 참이다($\mu = 0.5$)’ 였다.</p><ul><li>검정통계량값 = 12<li>검정통계량분포 = 이항분포 $B(15, 0.5)$</ul><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="n">t</span> <span class="o">=</span> <span class="mi">12</span> <span class="c1"># 검정통계량값
# 귀무가설을 따르는 검정통계량분포 
</span><span class="n">N</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">black</span> <span class="o">=</span> <span class="p">{</span><span class="s">'facecolor'</span> <span class="p">:</span> <span class="s">'black'</span><span class="p">}</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">).</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'동전 던지기 결과 베르누이분포의 검정통계량분포 : 이항분포 $B(15, 0.5)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'pmf'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">'실현된 검정통계량값 t=12'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.01</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mf">0.05</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">black</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">).</span><span class="n">cdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'검정통계량분포의 누적분포함수'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'cdf'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="734" alt="Screen Shot 2021-08-08 at 16 50 11" data-src="https://user-images.githubusercontent.com/83487073/128624980-e74fb54e-46cc-4a73-8dde-4b80453f7c3a.png" data-proofer-ignore></p><ul><li>양측검정유의확률을 계산하면 다음과 같다.</ul><p>$2(1-F(11))$</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">rv</span><span class="p">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="o">*</span><span class="mi">2</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'양측검정 유의확률 : </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s">'</span><span class="p">)</span>
</pre></table></code></div></div><p>계산 결과는 약 3.5% 다.</p><p>유의수준 5%에서는 유의확률이 더 작으므로, 귀무가설 기각하고 대립가설 채택할 수 있다. 즉 ‘동전이 불공정한 동전이다’ 라는 주장이 참이다.</p><p>한편 유의수준 1% 에서는 유의확률이 더 크므로, 귀무가설 기각할 수 없다. ‘동전이 불공정한 동전이다’라고 말할 수 있는 증거가 부족하다.</p><hr /><h1 id="예를-들어-직접-검정해보자---2">예를 들어 직접 검정해보자 - 2</h1><p>어떤 인터넷 쇼핑몰 상품 20개의 상품평이 있고, ‘좋아요’가 11개, ‘싫어요’가 9개다.</p><p>유의수준 10%에서 상품이 좋다는 주장을 검정해보자.</p><p>최대가능도 추정법으로 추정한 모수는 $\frac{11}{20}$ 이다.</p><p>베이즈추정법으로 추정해도 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">beta</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">10</span><span class="p">).</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>

<span class="k">print</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">vlines</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s">'r'</span><span class="p">)</span>
</pre></table></code></div></div><p><img width="736" alt="Screen Shot 2021-08-08 at 18 49 29" data-src="https://user-images.githubusercontent.com/83487073/128627932-cc1ec8e4-c2b4-45d8-83b1-6d70bb5a8ce8.png" data-proofer-ignore></p><p>모수추정 결과에 따르면 이 상품은 좋은 상품인 것 같다.</p><p>그러면 ‘이 상품이 좋은 상품이다!’라고 주장할 수 있을까?</p><p>내가 주장하고 싶은 바 : ‘상품이 좋은 상품이다’를 대립가설로 놓겠다.</p><p>$H_{a} : \mu &gt; 0.5$</p><p>귀무가설은 그러면 다음과 같다.</p><p>$H_{0} : \mu = 0.5$</p><p>귀무가설이 참인지 거짓인지 증명하기 위해, 검정통계량값을 구해보자.</p><p>주어진 ‘상품평 확률변수’가 베르누이확률변수이므로, 검정통계량 t 값은 N번 중 성공횟수 n 이다.</p><p>$n = 11$</p><p>이 검정통계량 값은 검정통계량분포를 따른다. 이 분포는 이항분포 $B(20, 0.5)$ 이다.</p><p>이 검정통계량 값이 이항분포 상에서 어디 위치하는 지 보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">mu0</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mu0</span><span class="p">).</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'상품평 확률변수의 검정통계량분포 $B(20, 0.5)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">annotate</span><span class="p">(</span><span class="s">'실현된 검정통계량 표본'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">xytext</span><span class="o">=</span><span class="p">[</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">],</span> <span class="n">arrowprops</span><span class="o">=</span><span class="n">black</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">stem</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mu0</span><span class="p">).</span><span class="n">cdf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'검정통계량분포의 누적분포함수'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</pre></table></code></div></div><p><img width="737" alt="Screen Shot 2021-08-08 at 18 59 13" data-src="https://user-images.githubusercontent.com/83487073/128628173-3ce11c6d-eb3a-447d-96d4-a4472f2a9bd2.png" data-proofer-ignore></p><p>대립가설이 부등식이고 모수가 특정값보다 크다 를 증명하려 하므로, 우측검정 유의확률 사용하면 된다.</p><p>$1-F(10)$ 값 계산하면 된다.</p><p>계산하면,</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">rv</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">binom</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">mu0</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">rv</span><span class="p">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">11</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p>약 0.411 (=41%) 이 나온다.</p><p>이 값은 유의수준 10% 보다 크다. 따라서 귀무가설 기각할 수 없다. 즉 상품이 좋다고 주장하기에는 증거가 부족하다.</p><hr /><h2 id="메모"><span class="mr-2">메모</span><a href="#메모" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>귀무가설-대립가설 설정에 깔려있는 stance :</ul><p>대립가설 - 내가 주장.증명 하려는 바</p><p>여기에 대해 ‘의심’하고 ‘증명’을 요구한다. 증명 성공하기 전 까진 보수적 기조를 유지한다.</p><p>보수적 기조 : 귀무가설(도전의 대상)</p><hr /><h2 id="검정-전-과정-내-언어로-요약"><span class="mr-2">검정 전 과정 내 언어로 요약.</span><a href="#검정-전-과정-내-언어로-요약" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>모수추정을 통해 확률변수 X의 모수를 추정했다.</ul><p>하지만 이 추정결과물은 ‘추정값’일 뿐, 정확한 모숫값이라고 말 못한다.</p><p>추정값이 참인가 거짓인가 따질 여지가 남아있다.</p><ul><li>모수 추정값이 참인가, 거짓인가 따져보자.</ul><p>나는 모숫값이 이번에 추정해 낸 바로 그 값이라고 주장하고 싶다.</p><p>이 추졍결과값을 가지고 대립가설($H_{a}$)을 세운다.</p><p>귀무가설은 최대한 보수적인 값으로 잡아둔다. 예) 가설의 기준이 되는 특정한 상수</p><p>내가 추정해낸 모숫값은 아직 확률변수 X의 모수라고 말 못하는 것이다.</p><p>따라서 확률변수 X의 확률분포 모수도 아직 귀무가설을 그대로 따른다.</p><ul><li>귀무가설이 참인지 거짓인지 증명하자.</ul><p>귀무가설 따르는 X 확률변수에서 얻어낸 표본데이터들을 가지고 검정통계량값 구한다.</p><p>검정통계량값이 따르는 검정통계량분포도 찾는다. 이 검정통계량분포 역시 귀무가설을 기본 전제로 따른다.</p><ul><li>검정통계량값이 검정통계량분포에서 어디쯤 위치하는지 보고, ‘귀무가설이 참일 때, 현재 검정통계량 값 &amp; 대립가설 더 옹호하는 값들이 나올 수 있는 확률=유의확률’을 계산한다.</ul><p>‘귀무가설을 기각할 지, 채택할 지 판단하는 ‘기준점’ 인 유의수준과 유의확률을 비교한다.</p><p>유의수준보다 유의확률이 낮으면, 귀무가설 기각 / 유의수준보다 유의확률이 높으면 귀무가설 채택한다.</p><ul><li>귀무가설이 기각되면 대립가설이 채택된다. 이 경우 내가 찾아낸 추정 결과값이 확률변수 X의 실제 모수를 잘 추정한 값이라고 믿을 수 있다.</ul><p>반면에 귀무가설이 채택되면 대립가설이 기각된다. 이 경우, 내가 찾아낸 추정 결과값이 거짓임을 의미한다. 이 경우 데이터를 더 모아야 한다.</p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/data-science/'>Data Science</a>, <a href='/categories/python/'>python</a>, <a href='/categories/mathematics/'>mathematics</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mathematics/" class="post-tag no-text-decoration" >mathematics</a> <a href="/tags/study/" class="post-tag no-text-decoration" >study</a> <a href="/tags/data-science/" class="post-tag no-text-decoration" >data science</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+%EB%B2%A0%EC%9D%B4%EC%A6%88%EC%B6%94%EC%A0%95%2C+%EA%B2%80%EC%A0%95%28testing%29+-+der+Wille+zur+Macht&url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fbasian_estimation%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+%EB%B2%A0%EC%9D%B4%EC%A6%88%EC%B6%94%EC%A0%95%2C+%EA%B2%80%EC%A0%95%28testing%29+-+der+Wille+zur+Macht&u=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fbasian_estimation%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkibeomkim.me%2Fposts%2Fbasian_estimation%2F&text=%5B%EC%88%98%ED%95%99%2F%ED%99%95%EB%A5%A0%EA%B3%BC+%ED%86%B5%EA%B3%84%5D+%EB%B2%A0%EC%9D%B4%EC%A6%88%EC%B6%94%EC%A0%95%2C+%EA%B2%80%EC%A0%95%28testing%29+-+der+Wille+zur+Macht" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="tigerkey10/bioinfo.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/classifier/">[알고리즘/지도학습] 로지스틱 회귀, 서포트벡터 머신, 나이브 베이즈 알고리듬, 분류모형 별 성능 비교</a><li><a href="/posts/regressor/">[알고리즘/지도학습] 회귀문제 - 선형회귀, 의사결정회귀나무, 의사결정회귀나무 앙상블(그래디언트 부스트)</a><li><a href="/posts/boosting/">[알고리즘/지도학습] 앙상블 알고리즘-부스팅(에이다 부스트, 그래디언트 부스트)</a><li><a href="/posts/ensemble/">[알고리즘/지도학습] 앙상블 알고리즘-취합(다수결 투표, 배깅, 랜덤포레스트)</a><li><a href="/posts/decision_tree/">[알고리즘/지도학습] 의사결정나무(Decision Tree) 알고리듬</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/percentage_recap2/"><div class="card-body"> <em class="small" data-ts="1624374000" data-df="YYYY-MM-DD" > 2021-06-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률론] 결합확률과 조건부확률, 결합확률분포 정의내리기- 확률론 기초 복습 (2)</h3><div class="text-muted small"><p> 2021-6월-23일 &amp;lt;6장 확률론 복습 -2 &amp;gt; 확률밀도함수 확률값과 똑같은 성질 갖는다. 확률밀도함숫값 p(x)는 항상 0 이상이다. -무한대~+무한대 구간 확률밀도함수 면적 구하면 1이다. 결합확률 P(A,B) or P(AnB) 사건 A,B가 동시에 발생할 확률 결합확률 P(A,B) or P(AnB) 사건...</p></div></div></a></div><div class="card"> <a href="/posts/random_variable/"><div class="card-body"> <em class="small" data-ts="1624719600" data-df="YYYY-MM-DD" > 2021-06-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 확률변수, 확률분포 모멘트</h3><div class="text-muted small"><p> 2021-06-27 7. 확률변수, 확률변수 모멘트 복습 확률변수 변환 기존 확률변수 이용해서 새 확률변수 만드는 것. 통계량 특정 표본값 전부를 하나의 공식에 넣어서 구해낸 하나의 값 큰 수의 법칙 표본평균 확률변수 기댓값은 원래 확률변수 기댓값과 같다. $E[\bar{X}] = E[X]$ $\Rightarrow$ 표본평균은 모평...</p></div></div></a></div><div class="card"> <a href="/posts/normal_distribution/"><div class="card-body"> <em class="small" data-ts="1626793200" data-df="YYYY-MM-DD" > 2021-07-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[수학/확률과 통계] 스튜던트 t분포, 카이제곱분포</h3><div class="text-muted small"><p> t분포 (스튜던트 t분포) : t통계량 분포 팻테일 현상 보이는 데이터에 적용하기 좋은 확률분포다. (예: 주식 일간수익률 데이터) 기댓값, 정밀도, 자유도를 모수로 갖는다. 자유도는 2이상의 자연수를 쓴다. 형상은 정규분포와 비슷하다. 자유도 = 1 인 t분포는 ‘코시분포’라고 부른다. t통계량의 분포다. t통계량 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/estimation/" class="btn btn-outline-primary" prompt="이전 글"><p>[수학/확률과 통계] 추정_기본개념, 모수추정- 모멘트방법, 최대가능도추정법</p></a> <a href="/posts/scipy_package_estimation/" class="btn btn-outline-primary" prompt="다음 글"><p>[수학/확률과 통계] Scipy 패키지를 이용한 검정 방법</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/tigerkey10/bioinfo.github.io">Ki Beom Kim</a>.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/mathematics/">mathematics</a> <a class="post-tag" href="/tags/data-science/">data science</a> <a class="post-tag" href="/tags/computer-science/">computer science</a> <a class="post-tag" href="/tags/datascience/">datascience</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/algorithm/">algorithm</a> <a class="post-tag" href="/tags/deep-learning/">Deep learning</a> <a class="post-tag" href="/tags/ml/">ML</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
